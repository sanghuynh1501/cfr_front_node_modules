{"ast":null,"code":"// Copyright (c) 2012 The Chromium Authors, Vladimirs. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/**\n * focus-outline-manager\n *\n * Watch users keyboard input and manage the focus outline visibility\n */\n\n/**\n * The class name to set on the document element.\n * @const\n */\nvar CLASS_NAME = 'focus-outline-hidden';\n/**\n * This class sets a CSS class name on the HTML element when a user presses the\n * tab key. It removes the class name when the user clicks anywhere.\n *\n * This allows you to write CSS like this:\n *\n * html.focus-outline-hidden *:focus {\n *     outline: none;\n * }\n *\n * And the outline will only be shown if the user uses the keyboard to get to it.\n *\n * @constructor\n */\n\nfunction FocusOutlineManager() {\n  var that = this;\n  document.addEventListener('keydown', function (e) {\n    that.focusByKeyboard = true;\n  }, true);\n  document.addEventListener('mousedown', function (e) {\n    that.focusByKeyboard = false;\n  }, true);\n  document.addEventListener('focus', function (event) {\n    // Update visibility only when focus is actually changed.\n    that.updateVisibility();\n  }, true);\n  document.addEventListener('focusout', function (event) {\n    window.setTimeout(function () {\n      if (!document.hasFocus()) {\n        that.focusByKeyboard = true;\n        that.updateVisibility();\n      }\n    }, 0);\n  });\n  this.updateVisibility();\n}\n\nFocusOutlineManager.prototype = {\n  /**\n   * Whether focus change is triggered by TAB key.\n   * @type {boolean}\n   * @private\n   */\n  focusByKeyboard: true,\n  updateVisibility: function updateVisibility() {\n    this.hidden = !this.focusByKeyboard;\n  },\n\n  /**\n   * Whether the focus outline should be hidden.\n   * @type {boolean}\n   */\n  set hidden(hidden) {\n    document.documentElement.classList.toggle(CLASS_NAME, hidden);\n  },\n\n  get hidden() {\n    return document.documentElement.classList.contains(CLASS_NAME);\n  }\n\n};\nnew FocusOutlineManager();","map":null,"metadata":{},"sourceType":"script"}