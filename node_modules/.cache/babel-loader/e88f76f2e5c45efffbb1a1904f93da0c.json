{"ast":null,"code":"import \"antd/es/switch/style\";\nimport _Switch from \"antd/es/switch\";\nimport _regeneratorRuntime from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/settings/TelegramAPISetting/index.jsx\";\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport client, { M_UPDATE_SETTING, Q_GET_SETTING } from '@graphql';\nimport { newNotification, parseError } from '@utils';\nimport { observer, inject } from 'mobx-react';\nimport './index.less';\nvar TelegramAPISetting = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(TelegramAPISetting, _React$PureComponent);\n\n  var _super = _createSuper(TelegramAPISetting);\n\n  function TelegramAPISetting(props) {\n    var _this;\n\n    _classCallCheck(this, TelegramAPISetting);\n\n    _this = _super.call(this, props);\n\n    _this.querySetting = function () {\n      return new Promise(function (resolve, reject) {\n        client.query({\n          query: Q_GET_SETTING,\n          fetchPolicy: 'network-only'\n        }).then(function (_ref2) {\n          var data = _ref2.data;\n          resolve(data.getSetting);\n        }).catch(function (err) {\n          newNotification(_this.props.i18n.t(parseError(err)), 'danger');\n          resolve(null);\n        });\n      });\n    };\n\n    _this.refetchData = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var setting, obj;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this.querySetting();\n\n            case 2:\n              setting = _context.sent;\n              obj = (setting === null || setting === void 0 ? void 0 : setting.telegramAPI) ? JSON.parse(setting.telegramAPI) : {};\n\n              _this.setState({\n                setting: obj\n              });\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.componentDidMount = function () {\n      _this.refetchData();\n    };\n\n    _this.handleUpdateSetting = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value) {\n        var data;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this.setState({\n                  loading: true\n                });\n\n                data = JSON.stringify({\n                  enable: value\n                });\n                client.mutate({\n                  mutation: M_UPDATE_SETTING,\n                  variables: {\n                    input: {\n                      telegramAPI: data\n                    }\n                  }\n                }).then(function (_ref5) {\n                  var data = _ref5.data;\n\n                  if (!data.updateSetting) {\n                    throw new Error('Cập nhật cấu hình thất bại.');\n                  }\n\n                  newNotification('Cập nhật cấu hình thành công.', 'success');\n\n                  _this.refetchData();\n\n                  setTimeout(function () {\n                    _this.setState({\n                      loading: false\n                    });\n                  }, 500);\n                }).catch(function (err) {\n                  newNotification(_this.props.i18n.t(parseError(err)), 'danger');\n                  setTimeout(function () {\n                    _this.setState({\n                      loading: false\n                    });\n                  }, 500);\n                });\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      visible: false,\n      setting: null,\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(TelegramAPISetting, [{\n    key: \"render\",\n    value: function render() {\n      var i18n = this.props.i18n;\n      var _this$state = this.state,\n          setting = _this$state.setting,\n          loading = _this$state.loading;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-telegram-api-setting\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-add-root-telegram-api\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"on-off\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }\n      }, \"Ho\\u1EA1t \\u0111\\u1ED9ng:\"), /*#__PURE__*/React.createElement(_Switch, {\n        checked: setting === null || setting === void 0 ? void 0 : setting.enable,\n        onChange: this.handleUpdateSetting,\n        loading: loading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-description\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }\n      }, i18n.t('setting.telegramAPI.description')), /*#__PURE__*/React.createElement(\"ul\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }\n      }, i18n.t('setting.telegramAPI.description1')))));\n    }\n  }]);\n\n  return TelegramAPISetting;\n}(React.PureComponent), _temp)) || _class) || _class);\nexport default withTranslation()(TelegramAPISetting);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/settings/TelegramAPISetting/index.jsx"],"names":["React","withTranslation","client","M_UPDATE_SETTING","Q_GET_SETTING","newNotification","parseError","observer","inject","TelegramAPISetting","stores","props","querySetting","Promise","resolve","reject","query","fetchPolicy","then","data","getSetting","catch","err","i18n","t","refetchData","setting","obj","telegramAPI","JSON","parse","setState","componentDidMount","handleUpdateSetting","value","loading","stringify","enable","mutate","mutation","variables","input","updateSetting","Error","setTimeout","state","visible","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withTranslation } from 'react-i18next'\nimport { Switch } from 'antd';\nimport client, { M_UPDATE_SETTING, Q_GET_SETTING } from '@graphql'\nimport { newNotification, parseError } from '@utils'\nimport { observer, inject } from 'mobx-react'\nimport './index.less'\n\n@inject(({ stores }) => stores)\n@observer\nclass TelegramAPISetting extends React.PureComponent {\n  constructor(props) {\n    super(props)\n    this.state = {\n      visible: false,\n      setting: null,\n      loading: false\n    }\n  }\n\n  querySetting = () => {\n    return new Promise((resolve, reject) => {\n      client\n        .query({\n          query: Q_GET_SETTING,\n          fetchPolicy: 'network-only'\n        })\n        .then(({ data }) => {\n          resolve(data.getSetting)\n        })\n        .catch(err => {\n          newNotification(this.props.i18n.t(parseError(err)), 'danger')\n          resolve(null)\n        })\n    })\n  }\n\n  refetchData = async () => {\n    const setting = await this.querySetting()\n    const obj = (setting?.telegramAPI) ? JSON.parse(setting.telegramAPI) : {}\n    this.setState({ setting: obj })\n  }\n\n  componentDidMount = () => {\n    this.refetchData()\n  }\n\n\n\n\n  handleUpdateSetting = async value => {\n    this.setState({ loading: true })\n\n    const data = JSON.stringify({\n      enable: value\n    })\n\n    client\n      .mutate({\n        mutation: M_UPDATE_SETTING,\n        variables: {\n          input: {\n            telegramAPI: data\n          }\n        }\n      })\n      .then(({ data }) => {\n        if (!data.updateSetting) {\n          throw new Error('Cập nhật cấu hình thất bại.')\n        }\n        newNotification('Cập nhật cấu hình thành công.', 'success')\n        this.refetchData()\n        setTimeout(() => {\n          this.setState({ loading: false })\n        }, 500)\n      })\n      .catch(err => {\n        newNotification(this.props.i18n.t(parseError(err)), 'danger')\n        setTimeout(() => {\n          this.setState({ loading: false })\n        }, 500)\n      })\n\n  }\n\n  render() {\n    const { i18n } = this.props\n    const { setting, loading } = this.state\n    return (\n      <div className='wrapper-telegram-api-setting'>\n        <div className='wrapper-add-root-telegram-api'>\n          <div className='on-off'>\n            <p>Hoạt động:</p>\n            <Switch\n              checked={setting?.enable}\n              onChange={this.handleUpdateSetting}\n              loading={loading}\n            />\n          </div>\n        </div>\n\n        <div className='wrapper-description'>\n          <p>{i18n.t('setting.telegramAPI.description')}</p>\n          <ul>\n            <li>{i18n.t('setting.telegramAPI.description1')}</li>\n          </ul>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(TelegramAPISetting)"]},"metadata":{},"sourceType":"module"}