{"ast":null,"code":"import \"antd/es/progress/style\";\nimport _Progress from \"antd/es/progress\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nimport _defineProperty from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/PollCollapse/ResultView.jsx\";\nimport React, { Component } from 'react'; // import { AvatarComponent } from '@components'\n\nimport moment from 'moment';\nimport { _pollType } from '@constants';\n\nvar ResultView = /*#__PURE__*/function (_Component) {\n  _inherits(ResultView, _Component);\n\n  var _super = _createSuper(ResultView);\n\n  function ResultView() {\n    var _this;\n\n    _classCallCheck(this, ResultView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      timeRemain: _this.props.conferenceState.pollsInfo[0].createdAt + _this.props.conferenceState.pollsInfo[0].duration - moment.now() + (moment.now() - _this.props.conferenceState.pollsInfo[0].createdAt)\n    };\n\n    _this.coundDown = function () {\n      if (_this.props.conferenceState.pollsInfo[0].createdAt + _this.props.conferenceState.pollsInfo[0].duration - moment.now() + (moment.now() - _this.props.conferenceState.pollsInfo[0].createdAt) <= 0) {\n        _this.props.handleEndPoll();\n\n        _this.setState({\n          timeRemain: 0\n        });\n\n        return clearInterval(_this.timeRemain);\n      }\n\n      _this.setState({\n        timeRemain: _this.props.conferenceState.pollsInfo[0].createdAt + _this.props.conferenceState.pollsInfo[0].duration - moment.now() + (moment.now() - _this.props.conferenceState.pollsInfo[0].createdAt)\n      });\n    };\n\n    _this.groupBy = function (items, key, type) {\n      // console.log('items', items)\n      if (type === _pollType.MULTIPLE) {\n        var multipleGroupedItems = [];\n        items.forEach(function (e) {\n          if (e.key === null) return;\n          e.key.forEach(function (i, index) {\n            multipleGroupedItems.push(_objectSpread({}, e, {\n              key: e.key[index]\n            }));\n          });\n        });\n        return multipleGroupedItems.reduce(function (result, item) {\n          return _objectSpread({}, result, _defineProperty({}, item[key], [].concat(_toConsumableArray(result[item[key]] || []), [item])));\n        }, {});\n      }\n\n      var groupedItems = items.reduce(function (result, item) {\n        return _objectSpread({}, result, _defineProperty({}, item[key], [].concat(_toConsumableArray(result[item[key]] || []), [item])));\n      }, {}); // console.log('groupedItems', groupedItems)\n\n      return groupedItems;\n    };\n\n    _this.dataToShow = function (items, key, type) {\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          groupBy = _assertThisInitialize.groupBy;\n\n      var obj = groupBy(items, key, type);\n      var res = []; // console.log('obj', obj)\n\n      for (var _key2 in obj) {\n        // console.log(key)\n        var a = {\n          key: _key2,\n          values: obj[_key2],\n          type: type\n        };\n        res.push(a);\n      }\n\n      return res;\n    };\n\n    return _this;\n  }\n\n  _createClass(ResultView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.conferenceState.pollsInfo[0].duration) {\n        this.timeRemain = setInterval(this.coundDown, 1000);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.timeRemain) {\n        clearInterval(this.timeRemain);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props$conferenc = this.props.conferenceState,\n          pollsInfo = _this$props$conferenc.pollsInfo,\n          conferenceUsers = _this$props$conferenc.conferenceUsers; // console.log('createdAt', moment(this.props.conferenceState.pollsInfo[0].createdAt).format('hh:mm:ss'))\n      // console.log('duration', moment(this.props.conferenceState.pollsInfo[0].duration).format('mm:ss'))\n      // console.log(\n      //   'endAt',\n      //   moment(\n      //     this.props.conferenceState.pollsInfo[0].createdAt + this.props.conferenceState.pollsInfo[0].duration\n      //   ).format('hh:mm:ss')\n      // )\n      // console.log('now', moment(+new Date()).format('hh:mm:ss'))\n      // console.log(\n      //   'timer run',\n      //   moment(\n      //     this.props.conferenceState.pollsInfo[0].createdAt +\n      //       this.props.conferenceState.pollsInfo[0].duration -\n      //       moment.now() +\n      //       (moment.now() - this.props.conferenceState.pollsInfo[0].createdAt)\n      //   ).format('mm:ss')\n      // )\n      // console.log('----------------------------------------')\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"resultViewHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }\n      }, \"C\\xE2u h\\u1ECFi kh\\u1EA3o s\\xE1t: \"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Col, {\n        style: {\n          borderRight: '1px solid #C4C4C4'\n        },\n        span: 10,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"question\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, \"C\\xE2u h\\u1ECFi\")), /*#__PURE__*/React.createElement(_Col, {\n        style: {\n          borderRight: '1px solid #C4C4C4'\n        },\n        span: 6,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"result\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 17\n        }\n      }, \"C\\xE1c k\\u1EBFt qu\\u1EA3\")), /*#__PURE__*/React.createElement(_Col, {\n        span: 8,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"graph\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 17\n        }\n      }, \"Thanh bi\\u1EC3u \\u0111\\u1ED3\"))))), pollsInfo.slice().sort(function (a, b) {\n        return a.createdAt - b.createdAt;\n      }).map(function (pollInfo, index) {\n        var userVotes = pollInfo.userVotes,\n            answers = pollInfo.answers,\n            duration = pollInfo.duration,\n            _id = pollInfo._id,\n            type = pollInfo.type;\n        var mappedUserVotes = userVotes.filter(function (e) {\n          return e.key !== null;\n        }); //Mapped data from data to show\n\n        var mappedData = _this2.dataToShow(mappedUserVotes, 'key', type); //Final data for displaying\n\n\n        var finalData = answers.map(function (e) {\n          return _objectSpread({}, e, {\n            values: mappedData.filter(function (k) {\n              return k.key === e.key;\n            }).pop() ? mappedData.filter(function (k) {\n              return k.key === e.key;\n            }).pop().values : []\n          });\n        });\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"resultView\",\n          key: _id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"resultQuestion\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 19\n          }\n        }, index + 1, \". \", pollInfo.question), duration && /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 21\n          }\n        }, _this2.state.timeRemain > 0 ? moment(_this2.state.timeRemain).format('mm:ss') : 'Hết giờ')), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"resultContent\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 17\n          }\n        }, type === _pollType.OPEN_ANSWER ? userVotes.filter(function (e) {\n          return e.key !== null;\n        }).map(function (e, i) {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            key: i,\n            className: \"resultContent\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 27\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"anwserHolder\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 29\n            }\n          }, /*#__PURE__*/React.createElement(_Row, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 31\n            }\n          }, /*#__PURE__*/React.createElement(_Col, {\n            span: 24,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 33\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            style: {\n              color: '#5D9C5A'\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 35\n            }\n          }, e.key)))));\n        }) : finalData.sort(function (a, b) {\n          return a.key.charCodeAt() - b.key.charCodeAt();\n        }).map(function (e, i) {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            key: e.key,\n            className: \"resultContent\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 27\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"anwserHolder\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 29\n            }\n          }, /*#__PURE__*/React.createElement(_Row, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 31\n            }\n          }, /*#__PURE__*/React.createElement(_Col, {\n            span: 10,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 33\n            }\n          }, e.key, \". \", e.value), /*#__PURE__*/React.createElement(_Col, {\n            span: 6,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 33\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 35\n            }\n          }, mappedUserVotes.filter(function (m) {\n            return m.key.includes(e.key);\n          }).length, \"/\", conferenceUsers.length), ' ', /*#__PURE__*/React.createElement(\"span\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 35\n            }\n          }, \"(\", Math.round(mappedUserVotes.filter(function (m) {\n            return m.key.includes(e.key);\n          }).length / conferenceUsers.length * 100), \"%)\")), /*#__PURE__*/React.createElement(_Col, {\n            span: 8,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 33\n            }\n          }, /*#__PURE__*/React.createElement(_Progress, {\n            status: 'normal',\n            percent: Math.round(mappedUserVotes.filter(function (m) {\n              return m.key.includes(e.key);\n            }).length / conferenceUsers.length * 100),\n            showInfo: false,\n            size: \"small\",\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 35\n            }\n          })))));\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"resultContent\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"anwserHolder\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(_Row, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(_Col, {\n          style: {\n            transform: 'translateX(-16px)'\n          },\n          span: 10,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 25\n          }\n        }, \"Kh\\xF4ng c\\xF3 c\\xE2u tr\\u1EA3 l\\u1EDDi\"), /*#__PURE__*/React.createElement(_Col, {\n          span: 6,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 27\n          }\n        }, type === _pollType.OPEN_ANSWER ? conferenceUsers.length - userVotes.filter(function (e) {\n          return e.key !== null && e.key[0].length !== 0;\n        }).length : conferenceUsers.length - mappedUserVotes.length, \"/\", conferenceUsers.length), ' ', /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 27\n          }\n        }, \"(\", Math.round((type === _pollType.OPEN_ANSWER ? conferenceUsers.length - userVotes.filter(function (e) {\n          return e.key !== null && e.key[0].length !== 0;\n        }).length : conferenceUsers.length - mappedUserVotes.length) / conferenceUsers.length * 100), \"%)\")), /*#__PURE__*/React.createElement(_Col, {\n          span: 8,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(_Progress, {\n          status: 'normal',\n          percent: Math.round((type === _pollType.OPEN_ANSWER ? conferenceUsers.length - userVotes.filter(function (e) {\n            return e.key !== null && e.key[0].length !== 0;\n          }).length : conferenceUsers.length - mappedUserVotes.length) / conferenceUsers.length * 100),\n          showInfo: false,\n          size: \"small\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 27\n          }\n        })))))));\n      }));\n    }\n  }]);\n\n  return ResultView;\n}(Component);\n\nexport { ResultView as default };","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/PollCollapse/ResultView.jsx"],"names":["React","Component","moment","_pollType","ResultView","state","timeRemain","props","conferenceState","pollsInfo","createdAt","duration","now","coundDown","handleEndPoll","setState","clearInterval","groupBy","items","key","type","MULTIPLE","multipleGroupedItems","forEach","e","i","index","push","reduce","result","item","groupedItems","dataToShow","obj","res","a","values","setInterval","conferenceUsers","borderRight","slice","sort","b","map","pollInfo","userVotes","answers","_id","mappedUserVotes","filter","mappedData","finalData","k","pop","question","format","OPEN_ANSWER","color","charCodeAt","value","m","includes","length","Math","round","transform"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n// import { AvatarComponent } from '@components'\nimport moment from 'moment'\nimport { _pollType } from '@constants'\nimport { Row, Col, Progress } from 'antd'\n\nexport default class ResultView extends Component {\n  state = {\n    timeRemain:\n      this.props.conferenceState.pollsInfo[0].createdAt +\n      this.props.conferenceState.pollsInfo[0].duration -\n      moment.now() +\n      (moment.now() - this.props.conferenceState.pollsInfo[0].createdAt)\n  }\n\n  componentDidMount() {\n    if (this.props.conferenceState.pollsInfo[0].duration) {\n      this.timeRemain = setInterval(this.coundDown, 1000)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.timeRemain) {\n      clearInterval(this.timeRemain)\n    }\n  }\n\n  coundDown = () => {\n    if (\n      this.props.conferenceState.pollsInfo[0].createdAt +\n        this.props.conferenceState.pollsInfo[0].duration -\n        moment.now() +\n        (moment.now() - this.props.conferenceState.pollsInfo[0].createdAt) <=\n      0\n    ) {\n      this.props.handleEndPoll()\n      this.setState({ timeRemain: 0 })\n      return clearInterval(this.timeRemain)\n    }\n    this.setState({\n      timeRemain:\n        this.props.conferenceState.pollsInfo[0].createdAt +\n        this.props.conferenceState.pollsInfo[0].duration -\n        moment.now() +\n        (moment.now() - this.props.conferenceState.pollsInfo[0].createdAt)\n    })\n  }\n\n  // group data by key\n  groupBy = (items, key, type) => {\n    // console.log('items', items)\n    if (type === _pollType.MULTIPLE) {\n      let multipleGroupedItems = []\n\n      items.forEach(e => {\n        if (e.key === null) return\n        e.key.forEach((i, index) => {\n          multipleGroupedItems.push({ ...e, key: e.key[index] })\n        })\n      })\n      return multipleGroupedItems.reduce(\n        (result, item) => ({\n          ...result,\n          [item[key]]: [...(result[item[key]] || []), item]\n        }),\n        {}\n      )\n    }\n    const groupedItems = items.reduce(\n      (result, item) => ({\n        ...result,\n        [item[key]]: [...(result[item[key]] || []), item]\n      }),\n      {}\n    )\n\n    // console.log('groupedItems', groupedItems)\n    return groupedItems\n  }\n  // format data\n  dataToShow = (items, key, type) => {\n    const { groupBy } = this\n    let obj = groupBy(items, key, type)\n    let res = []\n    // console.log('obj', obj)\n    for (let key in obj) {\n      // console.log(key)\n      let a = {\n        key,\n        values: obj[key],\n        type\n      }\n      res.push(a)\n    }\n    return res\n  }\n\n  render() {\n    const {\n      props: {\n        conferenceState: { pollsInfo, conferenceUsers }\n      }\n    } = this\n    // console.log('createdAt', moment(this.props.conferenceState.pollsInfo[0].createdAt).format('hh:mm:ss'))\n    // console.log('duration', moment(this.props.conferenceState.pollsInfo[0].duration).format('mm:ss'))\n    // console.log(\n    //   'endAt',\n    //   moment(\n    //     this.props.conferenceState.pollsInfo[0].createdAt + this.props.conferenceState.pollsInfo[0].duration\n    //   ).format('hh:mm:ss')\n    // )\n    // console.log('now', moment(+new Date()).format('hh:mm:ss'))\n    // console.log(\n    //   'timer run',\n    //   moment(\n    //     this.props.conferenceState.pollsInfo[0].createdAt +\n    //       this.props.conferenceState.pollsInfo[0].duration -\n    //       moment.now() +\n    //       (moment.now() - this.props.conferenceState.pollsInfo[0].createdAt)\n    //   ).format('mm:ss')\n    // )\n    // console.log('----------------------------------------')\n\n    return (\n      <>\n        <div className='resultViewHeader'>\n          <div className='title'>Câu hỏi khảo sát: </div>\n          <div className='header'>\n            <Row>\n              <Col style={{ borderRight: '1px solid #C4C4C4' }} span={10}>\n                <span className='question'>Câu hỏi</span>\n              </Col>\n              <Col style={{ borderRight: '1px solid #C4C4C4' }} span={6}>\n                <span className='result'>Các kết quả</span>\n              </Col>\n              <Col span={8}>\n                <span className='graph'>Thanh biểu đồ</span>\n              </Col>\n            </Row>\n          </div>\n        </div>\n        {pollsInfo\n          .slice()\n          .sort((a, b) => a.createdAt - b.createdAt)\n          .map((pollInfo, index) => {\n            const { userVotes, answers, duration, _id, type } = pollInfo\n\n            const mappedUserVotes = userVotes.filter(e => e.key !== null)\n\n            //Mapped data from data to show\n            const mappedData = this.dataToShow(mappedUserVotes, 'key', type)\n\n            //Final data for displaying\n            const finalData = answers.map(e => ({\n              ...e,\n              values: mappedData.filter(k => k.key === e.key).pop()\n                ? mappedData.filter(k => k.key === e.key).pop().values\n                : []\n            }))\n            return (\n              <div className='resultView' key={_id}>\n                <div className='resultQuestion'>\n                  <span>\n                    {index + 1}. {pollInfo.question}\n                  </span>\n                  {duration && (\n                    <span>{this.state.timeRemain > 0 ? moment(this.state.timeRemain).format('mm:ss') : 'Hết giờ'}</span>\n                  )}\n                </div>\n                <div className='resultContent'>\n                  {type === _pollType.OPEN_ANSWER\n                    ? userVotes\n                        .filter(e => e.key !== null)\n                        .map((e, i) => (\n                          <div key={i} className='resultContent'>\n                            <span className='anwserHolder'>\n                              <Row>\n                                <Col span={24}>\n                                  <span style={{ color: '#5D9C5A' }}>{e.key}</span>\n                                </Col>\n                              </Row>\n                            </span>\n                          </div>\n                        ))\n                    : finalData\n                        .sort((a, b) => a.key.charCodeAt() - b.key.charCodeAt())\n                        .map((e, i) => (\n                          <div key={e.key} className='resultContent'>\n                            <span className='anwserHolder'>\n                              <Row>\n                                <Col span={10}>\n                                  {e.key}. {e.value}\n                                </Col>\n\n                                <Col span={6}>\n                                  <span>\n                                    {mappedUserVotes.filter(m => m.key.includes(e.key)).length}/{conferenceUsers.length}\n                                  </span>{' '}\n                                  <span>\n                                    (\n                                    {Math.round(\n                                      (mappedUserVotes.filter(m => m.key.includes(e.key)).length /\n                                        conferenceUsers.length) *\n                                        100\n                                    )}\n                                    %)\n                                  </span>\n                                </Col>\n\n                                <Col span={8}>\n                                  <Progress\n                                    status={'normal'}\n                                    percent={Math.round(\n                                      (mappedUserVotes.filter(m => m.key.includes(e.key)).length /\n                                        conferenceUsers.length) *\n                                        100\n                                    )}\n                                    showInfo={false}\n                                    size='small'\n                                  />\n                                </Col>\n                              </Row>\n                            </span>\n                          </div>\n                        ))}\n                  <div className='resultContent'>\n                    <span className='anwserHolder'>\n                      <Row>\n                        <Col style={{ transform: 'translateX(-16px)' }} span={10}>\n                          Không có câu trả lời\n                        </Col>\n\n                        <Col span={6}>\n                          <span>\n                            {type === _pollType.OPEN_ANSWER\n                              ? conferenceUsers.length -\n                                userVotes.filter(e => e.key !== null && e.key[0].length !== 0).length\n                              : conferenceUsers.length - mappedUserVotes.length}\n                            /{conferenceUsers.length}\n                          </span>{' '}\n                          <span>\n                            (\n                            {Math.round(\n                              ((type === _pollType.OPEN_ANSWER\n                                ? conferenceUsers.length -\n                                  userVotes.filter(e => e.key !== null && e.key[0].length !== 0).length\n                                : conferenceUsers.length - mappedUserVotes.length) /\n                                conferenceUsers.length) *\n                                100\n                            )}\n                            %)\n                          </span>\n                        </Col>\n\n                        <Col span={8}>\n                          <Progress\n                            status={'normal'}\n                            percent={Math.round(\n                              ((type === _pollType.OPEN_ANSWER\n                                ? conferenceUsers.length -\n                                  userVotes.filter(e => e.key !== null && e.key[0].length !== 0).length\n                                : conferenceUsers.length - mappedUserVotes.length) /\n                                conferenceUsers.length) *\n                                100\n                            )}\n                            showInfo={false}\n                            size='small'\n                          />\n                        </Col>\n                      </Row>\n                    </span>\n                  </div>\n                </div>\n              </div>\n            )\n          })}\n      </>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}