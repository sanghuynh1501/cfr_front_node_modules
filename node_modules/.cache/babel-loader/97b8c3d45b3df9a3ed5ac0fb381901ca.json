{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/conference2/jitsi/components/DropdownRecord.jsx\",\n    _dec,\n    _class,\n    _temp;\n\n/* eslint-disable default-case */\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport iconBtnRec from \"@misc/images/toolbar/btn-rec.svg\";\nimport iconPause from \"@misc/images/toolbar/pause.svg\";\nimport iconStop from \"@misc/images/toolbar/stop.svg\";\nimport iconPlay from \"@misc/images/toolbar/play.svg\";\nimport client, { M_START_RECORD, M_PAUSE_RECORD, M_RESUME_RECORD } from '@graphql';\nimport { newNotification } from '@utils';\nimport { withTranslation } from 'react-i18next';\nimport { LoadingOutlined } from '@ant-design/icons';\nvar loadingIcon = /*#__PURE__*/React.createElement(LoadingOutlined, {\n  style: {\n    fontSize: 20,\n    color: '#fff',\n    marginRight: 10\n  },\n  spin: true,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 21\n  }\n});\nvar RECORD_RECODING = 1;\nvar RECORD_PAUSED = 2;\nvar timer = null;\n\nvar fillZero = function fillZero(time) {\n  return String(Math.floor(time)).padStart(2, '0');\n};\n\nvar timeToString = function timeToString(seconds) {\n  return \"\".concat(fillZero(seconds / 3600), \":\").concat(fillZero(seconds % 3600 / 60), \":\").concat(fillZero(seconds % 3600 % 60));\n};\n\nexport { timeToString };\nvar DropdownRecord = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(DropdownRecord, _React$PureComponent);\n\n  var _super = _createSuper(DropdownRecord);\n\n  function DropdownRecord(props) {\n    var _this;\n\n    _classCallCheck(this, DropdownRecord);\n\n    _this = _super.call(this, props);\n\n    _this.mutationStartRecord = function () {\n      _this.setState({\n        loading: true\n      });\n\n      client.mutate({\n        mutation: M_START_RECORD,\n        variables: {\n          conferenceId: _this.props.conferenceState.conference._id\n        }\n      }).then(function (res) {\n        var _res$data;\n\n        _this.setState({\n          loading: false\n        });\n\n        if (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.createRecord) {\n          return newNotification('Đang bắt đầu ghi hình!', 'success');\n        }\n\n        throw new Error('Có lỗi xảy ra!');\n      }).catch(function (err) {\n        _this.setState({\n          loading: false\n        });\n\n        var message = err === null || err === void 0 ? void 0 : err.graphQLErrors.map(function (er) {\n          return er.message;\n        }).join(',');\n        return newNotification(_this.props.i18n.t(message), 'danger');\n      });\n    };\n\n    _this.mutationPauseRecord = function () {\n      client.mutate({\n        mutation: M_PAUSE_RECORD,\n        variables: {\n          conferenceId: _this.props.conferenceState.conference._id\n        }\n      }).then(function (res) {\n        var _res$data2;\n\n        if (res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.pauseRecord) {\n          return newNotification('Đã tạm dừng ghi hình!', 'success');\n        }\n\n        throw new Error('Có lỗi xảy ra!');\n      }).catch(function (err) {\n        return newNotification(err.message, 'danger');\n      });\n    };\n\n    _this.mutationResumeRecord = function () {\n      client.mutate({\n        mutation: M_RESUME_RECORD,\n        variables: {\n          conferenceId: _this.props.conferenceState.conference._id\n        }\n      }).then(function (res) {\n        var _res$data3;\n\n        if (res === null || res === void 0 ? void 0 : (_res$data3 = res.data) === null || _res$data3 === void 0 ? void 0 : _res$data3.resumeRecord) {\n          return newNotification('Đã bắt đầu ghi hình!', 'success');\n        }\n\n        throw new Error('Có lỗi xảy ra!');\n      }).catch(function (err) {\n        return newNotification(err.message, 'danger');\n      });\n    };\n\n    _this.state = {\n      textTimer: '00:00:00',\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(DropdownRecord, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var recording = this.props.conferenceState.recording;\n      var loading = this.state.loading;\n\n      if (recording) {\n        switch (recording.state) {\n          case RECORD_RECODING:\n            {\n              if (!timer) {\n                timer = setInterval(function () {\n                  var seconds = Math.round((+new Date() - recording.lastStart) / 1000 + recording.duration);\n\n                  _this2.setState({\n                    textTimer: timeToString(seconds)\n                  });\n                }, 1000);\n              }\n\n              break;\n            }\n\n          case RECORD_PAUSED:\n            {\n              if (timer) {\n                clearInterval(timer);\n                timer = null;\n              }\n\n              var seconds = recording.duration;\n              this.setState({\n                textTimer: timeToString(seconds)\n              });\n              break;\n            }\n        }\n      } else {\n        if (timer) {\n          clearInterval(timer);\n          timer = null;\n          this.setState({\n            textTimer: '00:00:00'\n          });\n        }\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"recorder\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"record-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 9\n        }\n      }, \"Recorder\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"record-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 9\n        }\n      }, !recording && /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }\n      }, \"Click \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }\n      }, \"Record\"), \" to record the meeting\"), (recording === null || recording === void 0 ? void 0 : recording.state) === RECORD_RECODING && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"recording-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 52\n        }\n      }, \"Recording...\"), (recording === null || recording === void 0 ? void 0 : recording.state) === RECORD_PAUSED && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"paused-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 50\n        }\n      }, \"Meeting recording is paused\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"record-count\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 9\n        }\n      }, !recording ? '00:00:00' : this.state.textTimer), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"record-group-button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 9\n        }\n      }, !recording && /*#__PURE__*/React.createElement(_Button, {\n        disabled: loading,\n        className: \"btn-record\",\n        onClick: this.mutationStartRecord,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 13\n        }\n      }, loading ? /*#__PURE__*/React.createElement(_Spin, {\n        indicator: loadingIcon,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 26\n        }\n      }) : /*#__PURE__*/React.createElement(\"img\", {\n        src: iconBtnRec,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 61\n        }\n      }), \"Record\"), (recording === null || recording === void 0 ? void 0 : recording.state) && recording.state === RECORD_RECODING && /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        className: \"btn-pause\",\n        onClick: this.mutationPauseRecord,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: iconPause,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 17\n        }\n      }), \"Pause\"), /*#__PURE__*/React.createElement(_Button, {\n        className: \"btn-stop\",\n        onClick: this.props.showModalConfirmStopRecord,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: iconStop,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 17\n        }\n      }), \"Stop\")), (recording === null || recording === void 0 ? void 0 : recording.state) && recording.state === RECORD_PAUSED && /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        className: \"btn-resume\",\n        onClick: this.mutationResumeRecord,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: iconPlay,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 17\n        }\n      }), \"Resume\"), /*#__PURE__*/React.createElement(_Button, {\n        className: \"btn-stop\",\n        onClick: this.props.showModalConfirmStopRecord,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: iconStop,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 17\n        }\n      }), \"Stop\"))));\n    }\n  }]);\n\n  return DropdownRecord;\n}(React.PureComponent), _temp)) || _class) || _class);\nexport default withTranslation()(DropdownRecord);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/conference2/jitsi/components/DropdownRecord.jsx"],"names":["React","inject","observer","client","M_START_RECORD","M_PAUSE_RECORD","M_RESUME_RECORD","newNotification","withTranslation","LoadingOutlined","loadingIcon","fontSize","color","marginRight","RECORD_RECODING","RECORD_PAUSED","timer","fillZero","time","String","Math","floor","padStart","timeToString","seconds","DropdownRecord","stores","props","mutationStartRecord","setState","loading","mutate","mutation","variables","conferenceId","conferenceState","conference","_id","then","res","data","createRecord","Error","catch","err","message","graphQLErrors","map","er","join","i18n","t","mutationPauseRecord","pauseRecord","mutationResumeRecord","resumeRecord","state","textTimer","recording","setInterval","round","Date","lastStart","duration","clearInterval","iconBtnRec","iconPause","showModalConfirmStopRecord","iconStop","iconPlay","PureComponent"],"mappings":"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","sourcesContent":["/* eslint-disable default-case */\nimport React from 'react'\nimport { inject, observer } from 'mobx-react'\nimport { Button, Spin } from 'antd'\nimport iconBtnRec from '@misc/images/toolbar/btn-rec.svg'\nimport iconPause from '@misc/images/toolbar/pause.svg'\nimport iconStop from '@misc/images/toolbar/stop.svg'\nimport iconPlay from '@misc/images/toolbar/play.svg'\nimport client, { M_START_RECORD, M_PAUSE_RECORD, M_RESUME_RECORD } from '@graphql'\nimport { newNotification } from '@utils'\nimport { withTranslation } from 'react-i18next'\nimport { LoadingOutlined } from '@ant-design/icons'\nconst loadingIcon = <LoadingOutlined style={{ fontSize: 20, color: '#fff', marginRight: 10 }} spin />;\n\nconst RECORD_RECODING = 1\nconst RECORD_PAUSED = 2\n\nlet timer = null\n\nconst fillZero = time => String(Math.floor(time)).padStart(2, '0')\nconst timeToString = seconds =>\n  `${fillZero(seconds / 3600)}:${fillZero((seconds % 3600) / 60)}:${fillZero((seconds % 3600) % 60)}`\nexport { timeToString }\n\n@inject(({ stores }) => stores)\n@observer\nclass DropdownRecord extends React.PureComponent {\n  constructor(props) {\n    super(props)\n    this.state = {\n      textTimer: '00:00:00',\n      loading: false\n    }\n  }\n\n  mutationStartRecord = () => {\n    this.setState({ loading: true })\n    client\n      .mutate({\n        mutation: M_START_RECORD,\n        variables: {\n          conferenceId: this.props.conferenceState.conference._id\n        }\n      })\n      .then(res => {\n\n        this.setState({ loading: false })\n\n        if (res?.data?.createRecord) {\n          return newNotification('Đang bắt đầu ghi hình!', 'success')\n        }\n\n        throw new Error('Có lỗi xảy ra!')\n      })\n      .catch(err => {\n        this.setState({ loading: false })\n        const message = err?.graphQLErrors.map(er => er.message).join(',')\n        return newNotification(this.props.i18n.t(message), 'danger')\n      })\n  }\n\n  mutationPauseRecord = () => {\n    client\n      .mutate({\n        mutation: M_PAUSE_RECORD,\n        variables: {\n          conferenceId: this.props.conferenceState.conference._id\n        }\n      })\n      .then(res => {\n        if (res?.data?.pauseRecord) {\n          return newNotification('Đã tạm dừng ghi hình!', 'success')\n        }\n        throw new Error('Có lỗi xảy ra!')\n      })\n      .catch(err => {\n        return newNotification(err.message, 'danger')\n      })\n  }\n\n  mutationResumeRecord = () => {\n    client\n      .mutate({\n        mutation: M_RESUME_RECORD,\n        variables: {\n          conferenceId: this.props.conferenceState.conference._id\n        }\n      })\n      .then(res => {\n        if (res?.data?.resumeRecord) {\n          return newNotification('Đã bắt đầu ghi hình!', 'success')\n        }\n        throw new Error('Có lỗi xảy ra!')\n      })\n      .catch(err => {\n        return newNotification(err.message, 'danger')\n      })\n  }\n\n  render() {\n    const {\n      conferenceState: { recording }\n    } = this.props\n\n    const { loading } = this.state\n\n    if (recording) {\n      switch (recording.state) {\n        case RECORD_RECODING: {\n          if (!timer) {\n            timer = setInterval(() => {\n              const seconds = Math.round((+new Date() - recording.lastStart) / 1000 + recording.duration)\n              this.setState({\n                textTimer: timeToString(seconds)\n              })\n            }, 1000)\n          }\n          break\n        }\n        case RECORD_PAUSED: {\n          if (timer) {\n            clearInterval(timer)\n            timer = null\n          }\n          const seconds = recording.duration\n          this.setState({\n            textTimer: timeToString(seconds)\n          })\n          break\n        }\n      }\n    } else {\n      if (timer) {\n        clearInterval(timer)\n        timer = null\n        this.setState({ textTimer: '00:00:00' })\n      }\n    }\n\n    return (\n      <div className='recorder'>\n        <div className='record-title'>Recorder</div>\n        <div className='record-content'>\n          {!recording && (\n            <span>\n              Click <b>Record</b> to record the meeting\n            </span>\n          )}\n          {recording?.state === RECORD_RECODING && <span className='recording-icon'>Recording...</span>}\n          {recording?.state === RECORD_PAUSED && <span className='paused-icon'>Meeting recording is paused</span>}\n        </div>\n        <div className='record-count'>{!recording ? '00:00:00' : this.state.textTimer}</div>\n        <div className='record-group-button'>\n          {!recording && (\n            <Button\n              disabled={loading}\n              className='btn-record'\n              onClick={this.mutationStartRecord}\n            >\n              {loading ? <Spin indicator={loadingIcon} /> : <img src={iconBtnRec} alt='icon' />}\n              Record\n            </Button>\n          )}\n\n          {recording?.state && recording.state === RECORD_RECODING && (\n            <React.Fragment>\n              <Button className='btn-pause' onClick={this.mutationPauseRecord}>\n                <img src={iconPause} alt='icon' />\n                Pause\n              </Button>\n\n              <Button className='btn-stop' onClick={this.props.showModalConfirmStopRecord}>\n                <img src={iconStop} alt='icon' />\n                Stop\n              </Button>\n            </React.Fragment>\n          )}\n\n          {recording?.state && recording.state === RECORD_PAUSED && (\n            <React.Fragment>\n              <Button className='btn-resume' onClick={this.mutationResumeRecord}>\n                <img src={iconPlay} alt='icon' />\n                Resume\n              </Button>\n\n              <Button className='btn-stop' onClick={this.props.showModalConfirmStopRecord}>\n                <img src={iconStop} alt='icon' />\n                Stop\n              </Button>\n            </React.Fragment>\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(DropdownRecord)\n"]},"metadata":{},"sourceType":"module"}