{"ast":null,"code":"import _defineProperty from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/magicLink/index.jsx\";\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withTranslation } from 'react-i18next';\nimport { withRouter } from 'react-router-dom';\nimport './index.less';\nimport { client, M_ANONYMOUS_JOIN_CONFERENCE } from '@graphql';\nimport errorIcon from \"@misc/images/toolbar/error.svg\";\nimport logo from \"../../misc/logo/asset9.svg\";\nvar STATUS = {\n  VERIFY: 'VERIFY',\n  ERROR: 'ERROR'\n};\nvar MagicLink = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), withRouter(_class = _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(MagicLink, _React$PureComponent);\n\n  var _super = _createSuper(MagicLink);\n\n  function MagicLink() {\n    var _this;\n\n    _classCallCheck(this, MagicLink);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      status: STATUS.VERIFY\n    };\n\n    _this.backLogin = function () {\n      _this.props.history.push('/login');\n    };\n\n    return _this;\n  }\n\n  _createClass(MagicLink, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          globalState = _this$props.globalState,\n          match = _this$props.match; // MUTATION: CREATE CONFERENCE\n\n      client.mutate({\n        mutation: M_ANONYMOUS_JOIN_CONFERENCE,\n        variables: {\n          type: 'SYSTEM',\n          token: match.params.ID,\n          input: {\n            firstname: '',\n            lastname: ''\n          }\n        }\n      }).then(function (_ref2) {\n        var anonymousJoinConference = _ref2.data.anonymousJoinConference;\n\n        if (anonymousJoinConference) {\n          globalState.auth(anonymousJoinConference.accessToken);\n\n          _this2.props.history.push(\"/conference/\".concat(anonymousJoinConference.conferenceCode));\n        }\n      }).catch(function (error) {\n        globalState.clearStore();\n\n        _this2.setState({\n          status: STATUS.ERROR\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _renderElement;\n\n      var i18n = this.props.i18n;\n      var renderElement = (_renderElement = {}, _defineProperty(_renderElement, STATUS.VERIFY, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-verify\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }\n      }, i18n.t('verify.beingVerified')))), _defineProperty(_renderElement, STATUS.ERROR, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: errorIcon,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }\n      }, i18n.t('verify.confirmFailed')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.backLogin,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }\n      }, i18n.t('forgotPassword.goToLogin')))), _renderElement);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: logo,\n        alt: \"logo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 9\n        }\n      }), renderElement[this.state.status]);\n    }\n  }]);\n\n  return MagicLink;\n}(React.PureComponent), _temp)) || _class) || _class) || _class);\nexport default withTranslation()(MagicLink);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/magicLink/index.jsx"],"names":["React","inject","observer","withTranslation","withRouter","client","M_ANONYMOUS_JOIN_CONFERENCE","STATUS","VERIFY","ERROR","MagicLink","stores","state","status","backLogin","props","history","push","globalState","match","mutate","mutation","variables","type","token","params","ID","input","firstname","lastname","then","anonymousJoinConference","data","auth","accessToken","conferenceCode","catch","error","clearStore","setState","i18n","renderElement","t","errorIcon","logo","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { inject, observer } from 'mobx-react'\nimport { Button } from 'antd'\nimport { withTranslation } from 'react-i18next'\nimport { withRouter } from 'react-router-dom'\nimport './index.less'\n\nimport { client, M_ANONYMOUS_JOIN_CONFERENCE } from '@graphql'\n\nimport errorIcon from '@misc/images/toolbar/error.svg'\nimport logo from '../../misc/logo/asset9.svg'\n\n\nconst STATUS = {\n  VERIFY: 'VERIFY',\n  ERROR: 'ERROR'\n}\n\n@withRouter\n@inject(({ stores }) => stores)\n@observer\nclass MagicLink extends React.PureComponent {\n  state = {\n    status: STATUS.VERIFY\n  }\n\n  backLogin = () => {\n    this.props.history.push('/login')\n  }\n\n  componentDidMount() {\n    const {\n      props: { globalState, match }\n    } = this\n\n    // MUTATION: CREATE CONFERENCE\n    client\n      .mutate({\n        mutation: M_ANONYMOUS_JOIN_CONFERENCE,\n        variables: {\n          type: 'SYSTEM',\n          token: match.params.ID,\n          input: {\n            firstname: '',\n            lastname: ''\n          }\n        }\n      })\n      .then(({ data: { anonymousJoinConference } }) => {\n        if (anonymousJoinConference) {\n          globalState.auth(anonymousJoinConference.accessToken)\n          this.props.history.push(\n            `/conference/${anonymousJoinConference.conferenceCode}`\n          )\n        }\n      })\n      .catch(error => {\n        globalState.clearStore()\n        this.setState({ status: STATUS.ERROR })\n      })\n  }\n\n  render() {\n\n    const { i18n } = this.props\n\n    const renderElement = {\n      [STATUS.VERIFY]: (\n        <div className='wrapper-verify'>\n          <div className='loading'></div>\n          <p>{i18n.t('verify.beingVerified')}</p>\n        </div>\n      ),\n      [STATUS.ERROR]: (\n        <div className='wrapper-error'>\n          <img src={errorIcon} alt='icon' />\n          <p>{i18n.t('verify.confirmFailed')}</p>\n          <Button type='primary' onClick={this.backLogin}>{i18n.t('forgotPassword.goToLogin')}</Button>\n        </div>\n      )\n    }\n\n    return (\n      <div className='container'>\n        <img src={logo} alt='logo' />\n        {\n          renderElement[this.state.status]\n        }\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(MagicLink)"]},"metadata":{},"sourceType":"module"}