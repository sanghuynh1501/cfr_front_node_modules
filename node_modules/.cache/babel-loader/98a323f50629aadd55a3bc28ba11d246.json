{"ast":null,"code":"import \"antd/es/upload/style\";\nimport _Upload from \"antd/es/upload\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/progress/style\";\nimport _Progress from \"antd/es/progress\";\nimport _regeneratorRuntime from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/ShareFileCollapse/MyFiles.jsx\";\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { inject, observer } from 'mobx-react';\nimport client, { M_SET_FILE_CONFERENCE, Q_MY_FILES_CONFERENCE, M_DELETE_FILE } from '@graphql';\nimport debounce from 'lodash/debounce';\nimport { newNotification, returnError, parseError } from '@utils'; // import presentationOff from '@misc/images/sharefile-presentation/presentation-off.svg'\n// import presentationOn from '@misc/images/sharefile-presentation/presentation-on.svg'\n\nimport download from \"@misc/images/sharefile-presentation/download.svg\";\nimport shareOn from \"@misc/images/sharefile-presentation/share-on.svg\";\nimport shareOff from \"@misc/images/sharefile-presentation/share-off.svg\";\nimport remove from \"@misc/images/sharefile-presentation/remove.svg\";\nimport uploadFile from \"@misc/images/sharefile-presentation/upload.svg\";\nvar Search = _Input.Search;\nvar confirm = _Modal.confirm;\nvar MyFiles = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$Component) {\n  _inherits(MyFiles, _React$Component);\n\n  var _super = _createSuper(MyFiles);\n\n  function MyFiles(props) {\n    var _this;\n\n    _classCallCheck(this, MyFiles);\n\n    _this = _super.call(this, props);\n\n    _this.handleSearchFiles = function (value) {\n      _this.setState({\n        textSearch: value\n      }, function () {\n        _this.getMyFilesConference();\n      });\n    };\n\n    _this.getMyFilesConference = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _this$props$conferenc, _this$props$conferenc2;\n\n      var i18n;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              i18n = _this.props.i18n;\n              client.query({\n                query: Q_MY_FILES_CONFERENCE,\n                fetchPolicy: 'no-cache',\n                variables: {\n                  conferenceId: (_this$props$conferenc = _this.props.conferenceState) === null || _this$props$conferenc === void 0 ? void 0 : (_this$props$conferenc2 = _this$props$conferenc.conference) === null || _this$props$conferenc2 === void 0 ? void 0 : _this$props$conferenc2._id,\n                  inputSearch: {\n                    text: _this.state.textSearch\n                  }\n                }\n              }).then(function (_ref3) {\n                var myFilesConference = _ref3.data.myFilesConference;\n\n                if (!myFilesConference) {\n                  throw new Error();\n                }\n\n                _this.setState({\n                  myFiles: myFilesConference\n                });\n              }).catch(function (err) {\n                returnError('Error', {\n                  errorMessage: i18n.t(parseError(err))\n                }, {\n                  container: 'top-right'\n                });\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.setFileConference = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(fileId, input) {\n        var _conferenceState$conf;\n\n        var _this$props, i18n, conferenceState;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this$props = _this.props, i18n = _this$props.i18n, conferenceState = _this$props.conferenceState;\n                client.mutate({\n                  mutation: M_SET_FILE_CONFERENCE,\n                  fetchPolicy: 'no-cache',\n                  variables: {\n                    conferenceId: conferenceState === null || conferenceState === void 0 ? void 0 : (_conferenceState$conf = conferenceState.conference) === null || _conferenceState$conf === void 0 ? void 0 : _conferenceState$conf._id,\n                    fileId: fileId,\n                    input: input\n                  }\n                }).then(function (_ref5) {\n                  var setFileConference = _ref5.data.setFileConference;\n\n                  if (!setFileConference) {\n                    throw new Error();\n                  }\n\n                  return newNotification(i18n.t('conference.setFileConferenceSuccess'), 'success');\n                }).catch(function (err) {\n                  returnError('Error', {\n                    errorMessage: i18n.t(parseError(err))\n                  }, {\n                    container: 'top-right'\n                  });\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x, _x2) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.mutateDeleteFile = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(fileId) {\n        var _this$props2, i18n, conferenceState;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this$props2 = _this.props, i18n = _this$props2.i18n, conferenceState = _this$props2.conferenceState;\n                confirm({\n                  title: i18n.t('conference.notification'),\n                  content: i18n.t('conference.askDeleteFile'),\n                  okText: i18n.t('common.yes'),\n                  okType: 'danger',\n                  cancelText: i18n.t('common.no'),\n                  onOk: function onOk() {\n                    var _conferenceState$conf2;\n\n                    client.mutate({\n                      mutation: M_DELETE_FILE,\n                      fetchPolicy: 'no-cache',\n                      variables: {\n                        fileId: fileId,\n                        conferenceId: conferenceState === null || conferenceState === void 0 ? void 0 : (_conferenceState$conf2 = conferenceState.conference) === null || _conferenceState$conf2 === void 0 ? void 0 : _conferenceState$conf2._id\n                      }\n                    }).then(function (_ref7) {\n                      var deleteFile = _ref7.data.deleteFile;\n\n                      if (!deleteFile) {\n                        throw new Error();\n                      }\n\n                      return newNotification(i18n.t('conference.deleteFileSuccess'), 'success');\n                    }).catch(function (err) {\n                      returnError('Error', {\n                        errorMessage: i18n.t(parseError(err))\n                      }, {\n                        container: 'top-right'\n                      });\n                    });\n                  }\n                });\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x3) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    _this.componentDidMount = function () {\n      _this.getMyFilesConference();\n\n      _this.props.conferenceState.setFunc({\n        refetchMyFiles: _this.getMyFilesConference\n      });\n    };\n\n    _this.handleChangeUploadFile = /*#__PURE__*/function () {\n      var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(info) {\n        var status;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                status = info.file.status;\n\n                if (status === 'uploading') {\n                  _this.setState({\n                    uploading: true,\n                    filesUploading: info.fileList\n                  });\n                } else {\n                  _this.setState({\n                    uploading: false\n                  });\n\n                  _this.getMyFilesConference();\n                }\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x4) {\n        return _ref8.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      myFiles: [],\n      textSearch: '',\n      uploading: false,\n      filesUploading: []\n    };\n    _this.handleSearchFiles = debounce(_this.handleSearchFiles, 200);\n    return _this;\n  }\n\n  _createClass(MyFiles, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          myFiles = _this$state.myFiles,\n          uploading = _this$state.uploading;\n      var per = this.state.filesUploading.reduce(function (res, file) {\n        return res + file.percent;\n      }, 0) / this.state.filesUploading.length;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"my-files\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-control-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Search, {\n        className: \"search-files\",\n        placeholder: \"T\\xECm t\\u1EC7p tin\",\n        onChange: function onChange(_ref9) {\n          var value = _ref9.target.value;\n          return _this2.handleSearchFiles(value);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }\n      }), uploading && /*#__PURE__*/React.createElement(_Progress, {\n        style: {\n          padding: '0px 0px 0px 8px'\n        },\n        type: \"circle\",\n        percent: Math.round(per),\n        width: 30,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          display: uploading ? 'none' : 'block'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Upload, {\n        accept: \"image/*, .pdf\",\n        headers: {\n          'access-token': localStorage.getItem('access-token')\n        },\n        action: process.env.NODE_ENV === 'development' ? \"http://\".concat(process.env.REACT_APP_GRAPHQL_URN.split('/').shift(), \"/upload-file/file\") : \"\".concat(window.location.origin, \"/uploadcfr/upload-file/file\"),\n        name: \"rawImage\",\n        onChange: this.handleChangeUploadFile,\n        showUploadList: false,\n        multiple: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        shape: \"circle\",\n        className: \"btn-upload\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: uploadFile,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 17\n        }\n      }))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"list-item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 9\n        }\n      }, !myFiles.length && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"no-files\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 31\n        }\n      }, this.props.i18n.t('conference.noFileShared')), myFiles.map(function (file) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: file._id,\n          className: \"file-item\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"name\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 15\n          }\n        }, file.name), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"action\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 15\n          }\n        }, (file === null || file === void 0 ? void 0 : file.isShare) ? /*#__PURE__*/React.createElement(\"img\", {\n          src: shareOn,\n          alt: \"icon\",\n          onClick: function onClick() {\n            return _this2.setFileConference(file._id, {\n              isShare: false\n            });\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 19\n          }\n        }) : /*#__PURE__*/React.createElement(\"img\", {\n          src: shareOff,\n          alt: \"icon\",\n          onClick: function onClick() {\n            return _this2.setFileConference(file._id, {\n              isShare: true\n            });\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 19\n          }\n        }), /*#__PURE__*/React.createElement(\"img\", {\n          src: download,\n          alt: \"icon\",\n          onClick: function onClick() {\n            return window.open(file.path, '_blank');\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"img\", {\n          src: remove,\n          alt: \"icon\",\n          onClick: function onClick() {\n            return _this2.mutateDeleteFile(file._id);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 17\n          }\n        })));\n      })));\n    }\n  }]);\n\n  return MyFiles;\n}(React.Component), _temp)) || _class) || _class);\nexport default withTranslation()(MyFiles);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/ShareFileCollapse/MyFiles.jsx"],"names":["React","withTranslation","inject","observer","client","M_SET_FILE_CONFERENCE","Q_MY_FILES_CONFERENCE","M_DELETE_FILE","debounce","newNotification","returnError","parseError","Search","confirm","MyFiles","stores","props","handleSearchFiles","value","setState","textSearch","getMyFilesConference","i18n","query","fetchPolicy","variables","conferenceId","conferenceState","conference","_id","inputSearch","text","state","then","myFilesConference","data","Error","myFiles","catch","err","errorMessage","t","container","setFileConference","fileId","input","mutate","mutation","mutateDeleteFile","title","content","okText","okType","cancelText","onOk","deleteFile","componentDidMount","setFunc","refetchMyFiles","handleChangeUploadFile","info","status","file","uploading","filesUploading","fileList","per","reduce","res","percent","length","target","padding","Math","round","display","localStorage","getItem","process","env","NODE_ENV","REACT_APP_GRAPHQL_URN","split","shift","window","location","origin","uploadFile","map","name","isShare","shareOn","shareOff","download","open","path","remove","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withTranslation } from 'react-i18next'\nimport { inject, observer } from 'mobx-react'\nimport { Input, Modal, Upload, Button, Progress } from 'antd'\nimport client, { M_SET_FILE_CONFERENCE, Q_MY_FILES_CONFERENCE, M_DELETE_FILE } from '@graphql'\nimport debounce from 'lodash/debounce'\nimport { newNotification, returnError, parseError } from '@utils'\n// import presentationOff from '@misc/images/sharefile-presentation/presentation-off.svg'\n// import presentationOn from '@misc/images/sharefile-presentation/presentation-on.svg'\nimport download from '@misc/images/sharefile-presentation/download.svg'\nimport shareOn from '@misc/images/sharefile-presentation/share-on.svg'\nimport shareOff from '@misc/images/sharefile-presentation/share-off.svg'\nimport remove from '@misc/images/sharefile-presentation/remove.svg'\nimport uploadFile from '@misc/images/sharefile-presentation/upload.svg'\n\nconst { Search } = Input\nconst { confirm } = Modal\n\n\n@inject(({ stores }) => stores)\n@observer\nclass MyFiles extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      myFiles: [],\n      textSearch: '',\n      uploading: false,\n      filesUploading: []\n    }\n    this.handleSearchFiles = debounce(this.handleSearchFiles, 200)\n  }\n\n  handleSearchFiles = value => {\n    this.setState({ textSearch: value }, () => {\n      this.getMyFilesConference()\n    })\n  }\n\n  getMyFilesConference = async () => {\n    const { i18n } = this.props\n    client.query({\n      query: Q_MY_FILES_CONFERENCE,\n      fetchPolicy: 'no-cache',\n      variables: {\n        conferenceId: this.props.conferenceState?.conference?._id,\n        inputSearch: {\n          text: this.state.textSearch\n        }\n      }\n    })\n      .then(({ data: { myFilesConference } }) => {\n        if (!myFilesConference) {\n          throw new Error()\n        }\n        this.setState({ myFiles: myFilesConference })\n      })\n      .catch(err => {\n        returnError(\n          'Error',\n          { errorMessage: i18n.t(parseError(err)) },\n          { container: 'top-right' }\n        )\n      })\n  }\n\n  setFileConference = async (fileId, input) => {\n    const { i18n, conferenceState } = this.props\n    client.mutate({\n      mutation: M_SET_FILE_CONFERENCE,\n      fetchPolicy: 'no-cache',\n      variables: {\n        conferenceId: conferenceState?.conference?._id,\n        fileId,\n        input\n      }\n    })\n      .then(({ data: { setFileConference } }) => {\n        if (!setFileConference) {\n          throw new Error()\n        }\n        return newNotification(i18n.t('conference.setFileConferenceSuccess'), 'success')\n      })\n      .catch(err => {\n        returnError(\n          'Error',\n          { errorMessage: i18n.t(parseError(err)) },\n          { container: 'top-right' }\n        )\n      })\n  }\n\n  mutateDeleteFile = async (fileId) => {\n    const { i18n, conferenceState } = this.props\n    confirm({\n      title: i18n.t('conference.notification'),\n      content: i18n.t('conference.askDeleteFile'),\n      okText: i18n.t('common.yes'),\n      okType: 'danger',\n      cancelText: i18n.t('common.no'),\n      onOk() {\n        client.mutate({\n          mutation: M_DELETE_FILE,\n          fetchPolicy: 'no-cache',\n          variables: {\n            fileId,\n            conferenceId: conferenceState?.conference?._id\n          }\n        })\n          .then(({ data: { deleteFile } }) => {\n            if (!deleteFile) {\n              throw new Error()\n            }\n            return newNotification(i18n.t('conference.deleteFileSuccess'), 'success')\n          })\n          .catch(err => {\n            returnError(\n              'Error',\n              { errorMessage: i18n.t(parseError(err)) },\n              { container: 'top-right' }\n            )\n          })\n      }\n    })\n  }\n\n  componentDidMount = () => {\n    this.getMyFilesConference()\n    this.props.conferenceState.setFunc({ refetchMyFiles: this.getMyFilesConference })\n  }\n\n  handleChangeUploadFile = async info => {\n    const { file: { status } } = info\n    if (status === 'uploading') {\n      this.setState({ uploading: true, filesUploading: info.fileList })\n    } else {\n      this.setState({ uploading: false })\n      this.getMyFilesConference()\n    }\n  }\n\n  render() {\n    const { myFiles, uploading } = this.state\n    const per = this.state.filesUploading.reduce((res, file) => res + file.percent, 0) / this.state.filesUploading.length\n\n    return (\n      <div className='my-files'>\n        <div className='wrapper-control-btn'>\n          <Search\n            className='search-files'\n            placeholder='Tìm tệp tin'\n            onChange={({ target: { value } }) => this.handleSearchFiles(value)}\n          />\n\n          {uploading && (\n            <Progress\n              style={{ padding: '0px 0px 0px 8px' }}\n              type=\"circle\"\n              percent={Math.round(per)}\n              width={30}\n            />\n          )}\n\n\n          <div style={{ display: uploading ? 'none' : 'block' }}>\n            <Upload\n              accept='image/*, .pdf'\n              headers={{ 'access-token': localStorage.getItem('access-token') }}\n              action={\n                process.env.NODE_ENV === 'development'\n                  ? `http://${process.env.REACT_APP_GRAPHQL_URN.split('/').shift()}/upload-file/file`\n                  : `${window.location.origin}/uploadcfr/upload-file/file`\n              }\n              name='rawImage'\n              onChange={this.handleChangeUploadFile}\n              showUploadList={false}\n              multiple={true}\n            >\n              <Button shape='circle' className='btn-upload' >\n                <img src={uploadFile} alt='icon' />\n              </Button>\n            </Upload>\n          </div>\n        </div>\n\n        <div className='list-item'>\n          {!myFiles.length && <div className='no-files'>{this.props.i18n.t('conference.noFileShared')}</div>}\n          {myFiles.map(file =>\n            <div key={file._id} className='file-item'>\n              <div className='name'>\n                {file.name}\n              </div>\n\n              <div className='action'>\n                {file?.isShare ?\n                  <img\n                    src={shareOn}\n                    alt='icon'\n                    onClick={() => this.setFileConference(file._id, { isShare: false })}\n                  />\n                  :\n                  <img\n                    src={shareOff}\n                    alt='icon'\n                    onClick={() => this.setFileConference(file._id, { isShare: true })}\n                  />\n                }\n\n                {/* {file?.isPresentation ?\n                  <img\n                    src={presentationOn}\n                    alt='icon'\n                    onClick={() => this.setFileConference(file._id, { isPresentation: false })}\n                  />\n                  :\n                  <img\n                    src={presentationOff}\n                    alt='icon'\n                    style={file.type.includes('image') ? {} : { cursor: 'not-allowed', opacity: 0.5 }}\n                    onClick={() => this.setFileConference(file._id, { isPresentation: true })}\n                  />\n                } */}\n\n                <img src={download} alt='icon' onClick={() => window.open(file.path, '_blank')} />\n\n                <img src={remove} alt='icon' onClick={() => this.mutateDeleteFile(file._id)} />\n\n\n              </div>\n\n            </div>\n          )}\n\n        </div>\n\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(MyFiles)\n"]},"metadata":{},"sourceType":"module"}