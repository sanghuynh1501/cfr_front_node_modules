{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/profile/ModalDeleteAvatar.jsx\";\n\nimport React, { Component } from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { inject, observer } from 'mobx-react';\nimport { client, M_DELETE_AVATAR, Q_MY_INFO } from '@graphql';\nimport { returnError, newNotification } from '@utils';\nimport http from 'http';\nimport https from 'https';\nvar ModalDeleteAvatar = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_Component) {\n  _inherits(ModalDeleteAvatar, _Component);\n\n  var _super = _createSuper(ModalDeleteAvatar);\n\n  function ModalDeleteAvatar() {\n    var _this;\n\n    _classCallCheck(this, ModalDeleteAvatar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.delelePhoto = function () {\n      var idFile = _this.props.imageUrl.split('/').pop();\n\n      if (process.env.NODE_ENV === 'production') {\n        https.get(\"\".concat(window.location.origin, \"/uploadcfe/upload-file/remove/\").concat(idFile), function (resp) {\n          resp.on('data', function (chunk) {// let data = false\n            // data = chunk\n          });\n          resp.on('end', function () {});\n        }).on('error', function (err) {\n          console.error('Remove file: ', err);\n        });\n      } else if (process.env.NODE_ENV === 'development') {\n        http.get(\"http://\".concat(process.env.REACT_APP_GRAPHQL_URN.split('/').shift(), \"/upload-file/remove/\").concat(idFile), function (resp) {\n          resp.on('data', function (chunk) {// let data = false\n            // data = chunk\n          });\n          resp.on('end', function () {});\n        }).on('error', function (err) {\n          console.error('Remove file: ', err);\n        });\n      } else {\n        newNotification(\"Env \".concat(process.env.REACT_APP_GRAPHQL_URN, \" is not provide!\"), 'danger', {\n          container: 'top-right'\n        });\n        return;\n      }\n    };\n\n    _this.onCancel = function () {\n      _this.props.handleClose();\n    };\n\n    _this.queryMyInfo = function () {\n      return client.query({\n        query: Q_MY_INFO,\n        fetchPolicy: 'network-only'\n      }).then(function (_ref2) {\n        var myInfo = _ref2.data.myInfo;\n\n        if (myInfo) {\n          _this.props.globalState.setMyInfo(myInfo);\n        }\n      }).catch(function (error) {\n        return returnError('myInfo', {\n          error: error,\n          errorMessage: _this.props.i18n.t('notification.queryInfoError')\n        });\n      });\n    };\n\n    _this.onOk = function () {\n      client.mutate({\n        mutation: M_DELETE_AVATAR,\n        variables: {\n          userId: _this.props._id\n        }\n      }).then(function (e) {\n        _this.queryMyInfo();\n\n        _this.props.handleClose();\n\n        _this.delelePhoto();\n\n        newNotification(_this.props.i18n.t('notification.deleteAvatarSuccess'), 'success', {\n          container: 'top-right'\n        });\n      }).catch(function (error) {\n        return returnError('Get Link', {\n          error: error,\n          errorMessage: _this.props.i18n.t('notification.deleteAvatarError')\n        }, {\n          container: 'top-right'\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ModalDeleteAvatar, [{\n    key: \"render\",\n    value: function render() {\n      var i18n = this.props.i18n;\n      return /*#__PURE__*/React.createElement(_Modal, {\n        className: \"common-modal\",\n        title: i18n.t('user.deleteAvatar'),\n        onCancel: this.onCancel,\n        onOk: this.onOk,\n        visible: this.props.visible,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 9\n        }\n      }, i18n.t('user.titleDeleteAvatar')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.onOk,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }\n      }, i18n.t('common.delete')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        ghost: true,\n        onClick: this.onCancel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }\n      }, i18n.t('common.cancel'))));\n    }\n  }]);\n\n  return ModalDeleteAvatar;\n}(Component), _temp)) || _class) || _class);\nexport default withTranslation()(ModalDeleteAvatar);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/profile/ModalDeleteAvatar.jsx"],"names":["React","Component","withTranslation","inject","observer","client","M_DELETE_AVATAR","Q_MY_INFO","returnError","newNotification","http","https","ModalDeleteAvatar","stores","delelePhoto","idFile","props","imageUrl","split","pop","process","env","NODE_ENV","get","window","location","origin","resp","on","chunk","err","console","error","REACT_APP_GRAPHQL_URN","shift","container","onCancel","handleClose","queryMyInfo","query","fetchPolicy","then","myInfo","data","globalState","setMyInfo","catch","errorMessage","i18n","t","onOk","mutate","mutation","variables","userId","_id","e","visible"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withTranslation } from 'react-i18next'\nimport { inject, observer } from 'mobx-react'\nimport { Modal, Button } from 'antd'\n\nimport { client, M_DELETE_AVATAR, Q_MY_INFO } from '@graphql'\nimport { returnError, newNotification } from '@utils'\n\nimport http from 'http'\nimport https from 'https'\n\n@inject(({ stores }) => stores)\n@observer\nclass ModalDeleteAvatar extends Component {\n  delelePhoto = () => {\n    const idFile = this.props.imageUrl.split('/').pop()\n    if (process.env.NODE_ENV === 'production') {\n      https\n        .get(`${window.location.origin}/uploadcfe/upload-file/remove/${idFile}`, resp => {\n          resp.on('data', chunk => {\n            // let data = false\n            // data = chunk\n          })\n          resp.on('end', () => {\n\n          })\n        })\n        .on('error', err => {\n          console.error('Remove file: ', err)\n        })\n    } else if (process.env.NODE_ENV === 'development') {\n      http\n        .get(`http://${process.env.REACT_APP_GRAPHQL_URN.split('/').shift()}/upload-file/remove/${idFile}`, resp => {\n          resp.on('data', chunk => {\n            // let data = false\n            // data = chunk\n          })\n          resp.on('end', () => {\n\n          })\n        })\n        .on('error', err => {\n          console.error('Remove file: ', err)\n        })\n    } else {\n      newNotification(`Env ${process.env.REACT_APP_GRAPHQL_URN} is not provide!`, 'danger', {\n        container: 'top-right'\n      })\n      return\n    }\n  }\n  onCancel = () => {\n    this.props.handleClose()\n  }\n\n  queryMyInfo = () =>\n    client\n      .query({ query: Q_MY_INFO, fetchPolicy: 'network-only' })\n      .then(({ data: { myInfo } }) => {\n        if (myInfo) {\n          this.props.globalState.setMyInfo(myInfo)\n        }\n      })\n      .catch(error =>\n        returnError('myInfo', {\n          error,\n          errorMessage: this.props.i18n.t('notification.queryInfoError')\n        })\n      )\n\n\n  onOk = () => {\n    client\n      .mutate({\n        mutation: M_DELETE_AVATAR,\n        variables: {\n          userId: this.props._id\n        }\n      })\n      .then(e => {\n        this.queryMyInfo()\n        this.props.handleClose()\n        this.delelePhoto()\n        newNotification(this.props.i18n.t('notification.deleteAvatarSuccess'), 'success', {\n          container: 'top-right'\n        })\n      })\n      .catch(error =>\n        returnError(\n          'Get Link',\n          {\n            error,\n            errorMessage: this.props.i18n.t('notification.deleteAvatarError')\n          },\n          { container: 'top-right' }\n        )\n      )\n  }\n\n  render() {\n    const { i18n } = this.props\n    return (\n      <Modal\n        className='common-modal'\n        title={i18n.t('user.deleteAvatar')}\n        onCancel={this.onCancel}\n        onOk={this.onOk}\n        visible={this.props.visible}\n      >\n        <span>{i18n.t('user.titleDeleteAvatar')}</span>\n        <div className='wrapper-button'>\n          <Button type='primary' onClick={this.onOk}>\n            {i18n.t('common.delete')}\n          </Button>\n          <Button type='primary' ghost onClick={this.onCancel}>\n            {i18n.t('common.cancel')}\n          </Button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default withTranslation()(ModalDeleteAvatar)\n"]},"metadata":{},"sourceType":"module"}