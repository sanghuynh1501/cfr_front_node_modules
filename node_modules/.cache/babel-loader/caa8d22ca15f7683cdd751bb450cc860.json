{"ast":null,"code":"import _defineProperty from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport _toConsumableArray from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/components/tabsInviteRemind/TabInvite.jsx\";\n\nimport React from 'react';\nimport { withRouter } from 'react-router';\nimport { withTranslation } from 'react-i18next';\nimport { client, M_SEND_EMAIL, M_ADD_INVITE_EMAIL } from '@graphql';\nimport InputInvite from './InputInvite';\nimport googleCalendarAPI from '../../../../calendar/GoogleCalendarAPI';\nimport successIcon from \"@misc/images/toolbar/success.svg\";\nimport errorIcon from \"@misc/images/toolbar/error.svg\";\nimport { inject, observer } from 'mobx-react';\nvar STATUS = {\n  INVITE: 'INVITE',\n  SENDING: 'SENDING',\n  SENT: {\n    SUCCESS: 'SUCCESS',\n    ERROR: 'ERROR'\n  }\n};\nvar TabInvite = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), withRouter(_class = _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(TabInvite, _React$PureComponent);\n\n  var _super = _createSuper(TabInvite);\n\n  function TabInvite() {\n    var _this;\n\n    _classCallCheck(this, TabInvite);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      data: [],\n      status: STATUS.INVITE\n    };\n    _this.handleInvite = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var conference, emails;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!_this.props.globalState.isGoogleAPI) {\n                _context.next = 8;\n                break;\n              }\n\n              conference = _this.props.conference;\n\n              _this.setState(function (_preState) {\n                return _objectSpread({}, _preState, {\n                  status: STATUS.SENDING\n                });\n              });\n\n              emails = _this.state.data.filter(function (item) {\n                return item.validate;\n              }).map(function (item) {\n                return {\n                  email: item.value\n                };\n              });\n              _context.next = 6;\n              return googleCalendarAPI.inviteAttendee(conference.calendar._id.eventId, emails);\n\n            case 6:\n              client.mutate({\n                mutation: M_ADD_INVITE_EMAIL,\n                variables: {\n                  conferenceId: _this.props.match.params.ID,\n                  emails: emails.map(function (item) {\n                    return item.email;\n                  })\n                }\n              });\n\n              _this.setState(function (_preState) {\n                return _objectSpread({}, _preState, {\n                  status: STATUS.SENT.SUCCESS\n                });\n              });\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.handleSendEmail = function () {\n      _this.setState(function (_preState) {\n        return _objectSpread({}, _preState, {\n          status: STATUS.SENDING\n        });\n      });\n\n      var emailValidateTrue = _this.state.data.filter(function (item) {\n        return item.validate;\n      }).map(function (item) {\n        return item.value;\n      });\n\n      client.mutate({\n        mutation: M_SEND_EMAIL,\n        variables: {\n          typeSend: 'INVITE',\n          typeEmail: 'DETAIL_CONFERENCE',\n          conferenceId: _this.props.match.params.ID,\n          emails: emailValidateTrue\n        }\n      }).then(function (_ref3) {\n        var sendEmail = _ref3.data.sendEmail;\n\n        _this.setState(function (_preState) {\n          return _objectSpread({}, _preState, {\n            status: STATUS.SENT.SUCCESS\n          });\n        });\n      }).catch(function (error) {\n        _this.setState(function (_preState) {\n          return _objectSpread({}, _preState, {\n            status: STATUS.SENT.ERROR\n          });\n        });\n      });\n    };\n\n    _this.handleDeleteItem = function (item) {\n      _this.setState(function (_preState) {\n        return {\n          data: [].concat(_toConsumableArray(_preState.data.slice(0, item)), _toConsumableArray(_preState.data.slice(item + 1, _preState.data.length)))\n        };\n      });\n    };\n\n    _this.handleAddItem = function (item) {\n      var result = item.filter(function (e) {\n        return _this.state.data.findIndex(function (i) {\n          return i.value === e.value;\n        }) === -1;\n      });\n\n      if (result.length) {\n        _this.setState(function (_preState) {\n          return _objectSpread({}, _preState, {\n            data: [].concat(_toConsumableArray(_preState.data), _toConsumableArray(result))\n          });\n        });\n      }\n    };\n\n    _this.handleResetInvite = function () {\n      _this.setState(function (_preState) {\n        return _objectSpread({}, _preState, {\n          status: STATUS.INVITE,\n          data: []\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(TabInvite, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this,\n          _renderElement;\n\n      var i18n = this.props.i18n;\n      var countEmail = this.state.data.filter(function (item) {\n        return item.validate;\n      }).map(function (item) {\n        return item.value;\n      }).length;\n      var hasEmailValidate = countEmail > 0;\n      var renderElement = (_renderElement = {}, _defineProperty(_renderElement, STATUS.INVITE, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-invite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }\n      }, i18n.t('meeting.invitees')), /*#__PURE__*/React.createElement(InputInvite, {\n        data: this.state.data,\n        handleAddItem: this.handleAddItem,\n        handleDeleteItem: this.handleDeleteItem,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        disabled: !hasEmailValidate,\n        onClick: function onClick() {\n          if (_this2.props.type === 'calendar') {\n            _this2.handleInvite();\n          } else {\n            _this2.handleSendEmail();\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }\n      }, i18n.t('meeting.send')))), _defineProperty(_renderElement, STATUS.SENDING, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-loading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"spinner\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }\n      }, i18n.t('meeting.sendInvite')))), _defineProperty(_renderElement, STATUS.SENT.SUCCESS, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-sent\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: successIcon,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }\n      }, countEmail, \" \", i18n.t('meeting.sent')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"group-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.handleResetInvite,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.inviteMore')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        ghost: true,\n        onClick: this.props.handleCancel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.done'))))), _defineProperty(_renderElement, STATUS.SENT.ERROR, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-sent\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: errorIcon,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }\n      }, countEmail, \" \", i18n.t('meeting.notsent')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"group-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.handleResetInvite,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.inviteMore')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        ghost: true,\n        onClick: this.props.handleCancel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.done'))))), _renderElement);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-invite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 7\n        }\n      }, this.props.type === 'calendar' ? this.props.statusEvent === 'cancelled' ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-not-invite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 17\n        }\n      }, \"Vui l\\xF2ng th\\xEAm v\\xE0o Google Calendar\")) : this.props.conference.calendar ? renderElement[this.state.status] : /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-not-invite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 17\n        }\n      }, \"Vui l\\xF2ng th\\xEAm v\\xE0o Google Calendar\")) : renderElement[this.state.status]);\n    }\n  }]);\n\n  return TabInvite;\n}(React.PureComponent), _temp)) || _class) || _class) || _class);\nexport default withTranslation()(TabInvite);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/components/tabsInviteRemind/TabInvite.jsx"],"names":["React","withRouter","withTranslation","client","M_SEND_EMAIL","M_ADD_INVITE_EMAIL","InputInvite","googleCalendarAPI","inject","observer","STATUS","INVITE","SENDING","SENT","SUCCESS","ERROR","TabInvite","stores","state","data","status","handleInvite","props","globalState","isGoogleAPI","conference","setState","_preState","emails","filter","item","validate","map","email","value","inviteAttendee","calendar","_id","eventId","mutate","mutation","variables","conferenceId","match","params","ID","handleSendEmail","emailValidateTrue","typeSend","typeEmail","then","sendEmail","catch","error","handleDeleteItem","slice","length","handleAddItem","result","e","findIndex","i","handleResetInvite","i18n","countEmail","hasEmailValidate","renderElement","t","type","successIcon","handleCancel","errorIcon","statusEvent","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withRouter } from 'react-router'\nimport { withTranslation } from 'react-i18next'\nimport { Button } from 'antd'\n\nimport { client, M_SEND_EMAIL, M_ADD_INVITE_EMAIL } from '@graphql'\n\nimport InputInvite from './InputInvite'\nimport googleCalendarAPI from '../../../../calendar/GoogleCalendarAPI'\n\nimport successIcon from '@misc/images/toolbar/success.svg'\nimport errorIcon from '@misc/images/toolbar/error.svg'\nimport { inject, observer } from 'mobx-react'\n\nconst STATUS = {\n  INVITE: 'INVITE',\n  SENDING: 'SENDING',\n  SENT: {\n    SUCCESS: 'SUCCESS',\n    ERROR: 'ERROR'\n  }\n}\n\n@withRouter\n@inject(({ stores }) => stores)\n@observer\nclass TabInvite extends React.PureComponent {\n  state = {\n    data: [],\n    status: STATUS.INVITE\n  }\n\n  handleInvite = async () => {\n    // Google API\n    if (this.props.globalState.isGoogleAPI) {\n\n      const { conference } = this.props\n      this.setState(_preState => ({\n        ..._preState,\n        status: STATUS.SENDING\n      }))\n\n\n      const emails = this.state.data.filter(item => item.validate).map((item) => {\n        return {\n          email: item.value\n        }\n      })\n\n      await googleCalendarAPI.inviteAttendee(conference.calendar._id.eventId, emails)\n\n      client\n        .mutate({\n          mutation: M_ADD_INVITE_EMAIL,\n          variables: {\n            conferenceId: this.props.match.params.ID,\n            emails: emails.map(item => item.email)\n          }\n        })\n\n      this.setState(_preState => ({\n        ..._preState,\n        status: STATUS.SENT.SUCCESS\n      }))\n\n    }\n  }\n\n  handleSendEmail = () => {\n    this.setState(_preState => ({\n      ..._preState,\n      status: STATUS.SENDING\n    }))\n\n    const emailValidateTrue = this.state.data.filter(item => item.validate).map(item => item.value)\n    client\n      .mutate({\n        mutation: M_SEND_EMAIL,\n        variables: {\n          typeSend: 'INVITE',\n          typeEmail: 'DETAIL_CONFERENCE',\n          conferenceId: this.props.match.params.ID,\n          emails: emailValidateTrue\n        }\n      })\n      .then(({ data: { sendEmail } }) => {\n        this.setState(_preState => ({\n          ..._preState,\n          status: STATUS.SENT.SUCCESS\n        }))\n      })\n      .catch(error => {\n        this.setState(_preState => ({\n          ..._preState,\n          status: STATUS.SENT.ERROR\n        }))\n      })\n  }\n\n  handleDeleteItem = (item) => {\n    this.setState(_preState => ({\n      data: [..._preState.data.slice(0, item), ..._preState.data.slice(item + 1, _preState.data.length)]\n    }))\n  }\n\n  handleAddItem = (item) => {\n    const result = item.filter(e => this.state.data.findIndex(i => i.value === e.value) === -1)\n    if (result.length) {\n      this.setState(_preState => ({\n        ..._preState,\n        data: [..._preState.data, ...result]\n      }))\n    }\n  }\n\n  handleResetInvite = () => {\n    this.setState(_preState => ({\n      ..._preState,\n      status: STATUS.INVITE,\n      data: []\n    }))\n  }\n\n  render() {\n    const { i18n } = this.props\n    const countEmail = this.state.data.filter(item => item.validate).map(item => item.value).length\n    const hasEmailValidate = countEmail > 0\n\n    const renderElement = {\n      [STATUS.INVITE]: (\n        <div className='box-invite'>\n          <p>{i18n.t('meeting.invitees')}</p>\n          <InputInvite\n            data={this.state.data}\n            handleAddItem={this.handleAddItem}\n            handleDeleteItem={this.handleDeleteItem}\n          />\n          <Button\n            type='primary'\n            disabled={!hasEmailValidate}\n            onClick={() => {\n              if (this.props.type === 'calendar') {\n                this.handleInvite()\n              } else {\n                this.handleSendEmail()\n              }\n            }}\n          >\n            {i18n.t('meeting.send')}\n          </Button>\n        </div>\n      ),\n      [STATUS.SENDING]: (\n        <div className='box-loading'>\n          <div className='spinner'></div>\n          <p>{i18n.t('meeting.sendInvite')}</p>\n        </div>\n      ),\n      [STATUS.SENT.SUCCESS]: (\n        <div className='box-sent'>\n          <img src={successIcon} alt='icon' />\n          <span className='success'>{countEmail} {i18n.t('meeting.sent')}</span>\n          <div className='group-btn'>\n            <Button type='primary' onClick={this.handleResetInvite}>{i18n.t('meeting.inviteMore')}</Button>\n            <Button type='primary' ghost onClick={this.props.handleCancel}>{i18n.t('meeting.done')}</Button>\n          </div>\n        </div>\n      ),\n      [STATUS.SENT.ERROR]: (\n        <div className='box-sent'>\n          <img src={errorIcon} alt='icon' />\n          <span className='error'>{countEmail} {i18n.t('meeting.notsent')}</span>\n          <div className='group-btn'>\n            <Button type='primary' onClick={this.handleResetInvite}>{i18n.t('meeting.inviteMore')}</Button>\n            <Button type='primary' ghost onClick={this.props.handleCancel}>{i18n.t('meeting.done')}</Button>\n          </div>\n        </div>\n      ),\n    }\n\n    return (\n      <div className='wrapper-invite'>\n        {\n          this.props.type === 'calendar' ? (\n            this.props.statusEvent === 'cancelled' ? (\n              <div className='wrapper-not-invite'>\n                <p>Vui lòng thêm vào Google Calendar</p>\n              </div>\n            ) : (this.props.conference.calendar ? (\n              renderElement[this.state.status]\n            ) :\n              <div className='wrapper-not-invite'>\n                <p>Vui lòng thêm vào Google Calendar</p>\n              </div>\n              )\n          ) : renderElement[this.state.status]\n        }\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(TabInvite)\n"]},"metadata":{},"sourceType":"module"}