{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport _objectSpread from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/webinars/components/ModalCreatePoll.jsx\";\nimport React from 'react';\nimport './ModalCreatePoll.less';\nimport { client, M_CREATE_QUESTION_POLL, M_CREATE_WEBINAR_POLL } from '@graphql';\nimport { returnError, newNotification } from '@utils';\nimport QuestionPoll from './QuestionPoll';\n\nvar ModalCreatePoll = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(ModalCreatePoll, _React$PureComponent);\n\n  var _super = _createSuper(ModalCreatePoll);\n\n  function ModalCreatePoll() {\n    var _this;\n\n    _classCallCheck(this, ModalCreatePoll);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      visible: false,\n      order: 1,\n      pollId: null,\n      questions: [{\n        id: 'QUES-1',\n        question: '',\n        type: ''\n      }]\n    };\n\n    _this.handleAddQuestion = function () {\n      _this.setState(function (_preState) {\n        return {\n          order: _preState.order + 1,\n          questions: [].concat(_toConsumableArray(_preState.questions), [{\n            id: \"QUES-\".concat(_preState.order + 1),\n            question: '',\n            type: ''\n          }])\n        };\n      });\n    };\n\n    _this.handleDeleteQuesion = function (index) {\n      _this.setState(function (_preState) {\n        return {\n          questions: [].concat(_toConsumableArray(_preState.questions.slice(0, index)), _toConsumableArray(_preState.questions.slice(index + 1, _preState.questions.length)))\n        };\n      });\n    };\n\n    _this.showModal = function () {\n      _this.setState({\n        visible: true\n      });\n    };\n\n    _this.handleCheckEmpty = function () {\n      var data = [];\n\n      _this.state.questions.map(function (item) {\n        _this.refs[item.id].validateFields(function (err, values) {\n          if (!err) {\n            var convertData = {\n              question: values.question,\n              type: values.type,\n              answers: _toConsumableArray(Object.values(values).slice(2, 10).map(function (item, index) {\n                return {\n                  key: String.fromCharCode(65 + index),\n                  value: item\n                };\n              }))\n            };\n            data.push(convertData);\n          }\n        });\n\n        return false;\n      });\n\n      return data;\n    };\n\n    _this.mutationCreatePoll = function (data) {\n      client.mutate({\n        mutation: M_CREATE_WEBINAR_POLL,\n        variables: {\n          newWebinarPollInput: {\n            webinarId: _this.props.webinarId,\n            name: _this.refs['name-poll'].state.value || 'Poll'\n          }\n        }\n      }).then(function (_ref) {\n        var createWebinarPoll = _ref.data.createWebinarPoll;\n        newNotification('Create webinar poll success', 'success', {\n          container: 'top-right'\n        });\n        var temp = data.map(function (item) {\n          return _objectSpread({}, item, {\n            webinarPollId: createWebinarPoll\n          });\n        });\n\n        _this.mutationCreateQuestion(temp);\n      }).catch(function (error) {\n        return returnError('Get webinar templates', {\n          error: error,\n          errorMessage: 'Cannot create webinar poll, try again later!'\n        }, {\n          container: 'top-center'\n        });\n      });\n    };\n\n    _this.mutationCreateQuestion = function (data) {\n      client.mutate({\n        mutation: M_CREATE_QUESTION_POLL,\n        variables: {\n          newWebinarPollQuestionInput: data\n        }\n      }).then(function (_ref2) {\n        var createWebinarPollQuestion = _ref2.data.createWebinarPollQuestion;\n\n        if (createWebinarPollQuestion) {\n          newNotification('Create question success', 'success', {\n            container: 'top-right'\n          });\n        }\n      }).catch(function (error) {\n        return returnError('Get webinar templates', {\n          error: error,\n          errorMessage: 'Cannot create question, try again later!'\n        }, {\n          container: 'top-right'\n        });\n      });\n    };\n\n    _this.handleOk = function (e) {\n      var data = _this.handleCheckEmpty();\n\n      if (data.length === _this.state.questions.length) {\n        _this.mutationCreatePoll(data);\n      }\n    };\n\n    _this.handleCancel = function (e) {\n      _this.setState({\n        visible: false\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ModalCreatePoll, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.showModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 9\n        }\n      }, \"Add\"), /*#__PURE__*/React.createElement(_Modal, {\n        title: \"Add a poll\",\n        visible: this.state.visible,\n        onOk: this.handleOk,\n        centered: true,\n        onCancel: this.handleCancel,\n        okText: \"Create\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(_Input, {\n        ref: \"name-poll\",\n        placeholder: \"Enter the title for this poll\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }\n      }), this.state.questions.map(function (item, index) {\n        return /*#__PURE__*/React.createElement(QuestionPoll, {\n          key: item.id,\n          ref: item.id,\n          index: index,\n          lenQuestion: _this2.state.questions.length,\n          handleDeleteQuesion: _this2.handleDeleteQuesion,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 17\n          }\n        });\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.handleAddQuestion,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }\n      }, \"Add a Question\"))));\n    }\n  }]);\n\n  return ModalCreatePoll;\n}(React.PureComponent);\n\nexport default ModalCreatePoll;","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/webinars/components/ModalCreatePoll.jsx"],"names":["React","client","M_CREATE_QUESTION_POLL","M_CREATE_WEBINAR_POLL","returnError","newNotification","QuestionPoll","ModalCreatePoll","state","visible","order","pollId","questions","id","question","type","handleAddQuestion","setState","_preState","handleDeleteQuesion","index","slice","length","showModal","handleCheckEmpty","data","map","item","refs","validateFields","err","values","convertData","answers","Object","key","String","fromCharCode","value","push","mutationCreatePoll","mutate","mutation","variables","newWebinarPollInput","webinarId","props","name","then","createWebinarPoll","container","temp","webinarPollId","mutationCreateQuestion","catch","error","errorMessage","newWebinarPollQuestionInput","createWebinarPollQuestion","handleOk","e","handleCancel","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Button, Modal, Input } from 'antd'\nimport './ModalCreatePoll.less'\n\nimport { client, M_CREATE_QUESTION_POLL, M_CREATE_WEBINAR_POLL } from '@graphql'\nimport { returnError, newNotification } from '@utils'\n\nimport QuestionPoll from './QuestionPoll'\n\nclass ModalCreatePoll extends React.PureComponent {\n  state = {\n    visible: false,\n    order: 1,\n    pollId: null,\n    questions: [\n      {\n        id: 'QUES-1',\n        question: '',\n        type: ''\n      }\n    ]\n  }\n\n  handleAddQuestion = () => {\n    this.setState(_preState => ({\n      order: _preState.order + 1,\n      questions: [\n        ..._preState.questions,\n        {\n          id: `QUES-${_preState.order + 1}`,\n          question: '',\n          type: ''\n        }\n      ]\n    }))\n  }\n\n  handleDeleteQuesion = (index) => {\n    this.setState(_preState => ({\n      questions: [..._preState.questions.slice(0, index), ..._preState.questions.slice(index + 1, _preState.questions.length)]\n    }))\n  }\n\n  showModal = () => {\n    this.setState({\n      visible: true,\n    })\n  }\n\n  handleCheckEmpty = () => {\n    let data = []\n    this.state.questions.map(item => {\n      this.refs[item.id].validateFields((err, values) => {\n        if (!err) {\n          const convertData = {\n            question: values.question,\n            type: values.type,\n            answers: [...Object.values(values).slice(2, 10).map((item, index) => {\n              return {\n                key: String.fromCharCode(65 + index),\n                value: item\n              }\n            })]\n          }\n          data.push(convertData)\n        }\n      })\n      return false\n    })\n    return data\n  }\n\n  mutationCreatePoll = (data) => {\n    client\n      .mutate({\n        mutation: M_CREATE_WEBINAR_POLL,\n        variables: {\n          newWebinarPollInput: {\n            webinarId: this.props.webinarId,\n            name: this.refs['name-poll'].state.value || 'Poll'\n          }\n        }\n      })\n      .then(({ data: { createWebinarPoll } }) => {\n        newNotification('Create webinar poll success', 'success', { container: 'top-right' })\n        const temp  = data.map(item => {\n          return {\n            ...item,\n            webinarPollId: createWebinarPoll\n          }\n        })\n\n        this.mutationCreateQuestion(temp)\n      })\n      .catch(error =>\n        returnError(\n          'Get webinar templates',\n          {\n            error,\n            errorMessage: 'Cannot create webinar poll, try again later!'\n          },\n          { container: 'top-center' }\n        )\n      )\n  }\n\n  mutationCreateQuestion = (data) => {\n    client\n      .mutate({\n        mutation: M_CREATE_QUESTION_POLL,\n        variables: {\n          newWebinarPollQuestionInput: data\n        }\n      })\n      .then(({ data: { createWebinarPollQuestion } }) => {\n        if(createWebinarPollQuestion) {\n          newNotification('Create question success', 'success', { container: 'top-right' })\n        }\n      })\n      .catch(error =>\n        returnError(\n          'Get webinar templates',\n          {\n            error,\n            errorMessage: 'Cannot create question, try again later!'\n          },\n          { container: 'top-right' }\n        )\n      )\n  }\n\n  handleOk = e => {\n    const data = this.handleCheckEmpty()\n    if (data.length === this.state.questions.length) {\n      this.mutationCreatePoll(data)\n    }\n  }\n\n  handleCancel = e => {\n    this.setState({\n      visible: false,\n    })\n  }\n\n  render() {\n    return (\n      <>\n        <Button type='primary' onClick={this.showModal}>Add</Button>\n        <Modal\n          title=\"Add a poll\"\n          visible={this.state.visible}\n          onOk={this.handleOk}\n          centered\n          onCancel={this.handleCancel}\n          okText='Create'\n        >\n          <Input ref='name-poll' placeholder=\"Enter the title for this poll\" />\n          {\n            this.state.questions.map((item, index) => {\n              return (\n                <QuestionPoll\n                  key={item.id}\n                  ref={item.id}\n                  index={index}\n                  lenQuestion={this.state.questions.length}\n                  handleDeleteQuesion={this.handleDeleteQuesion}\n                />\n              )\n            })\n          }\n          <div className='wrapper-button'>\n            <Button type='primary' onClick={this.handleAddQuestion}>Add a Question</Button>\n          </div>\n        </Modal>\n      </>\n    )\n  }\n}\n\nexport default ModalCreatePoll"]},"metadata":{},"sourceType":"module"}