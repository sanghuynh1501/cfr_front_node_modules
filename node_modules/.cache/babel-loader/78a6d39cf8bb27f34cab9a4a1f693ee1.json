{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/icon/style\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/checkbox/style\";\nimport _Checkbox from \"antd/es/checkbox\";\nimport \"antd/es/radio/style\";\nimport _Radio from \"antd/es/radio\";\nimport _defineProperty from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/PollCollapse/UserView.jsx\";\n\nimport React, { Component } from 'react';\nimport { checkPermission, _pollType } from '@constants';\nimport { inject, observer } from 'mobx-react';\nimport { client, M_VOTE } from '@graphql';\nimport moment from 'moment';\nimport { returnError, newNotification } from '@utils';\nvar UserView = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_Component) {\n  _inherits(UserView, _Component);\n\n  var _super = _createSuper(UserView);\n\n  function UserView() {\n    var _this;\n\n    _classCallCheck(this, UserView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      initVal: _this.props.conferenceState.pollsInfo.map(function (e) {\n        return {\n          //Generate initial value for user answer\n          pollId: e._id,\n          answerKey: e.userVotes ? e.userVotes.map(function (e) {\n            return e.user._id;\n          }).includes(_this.props.conferenceState.myInfo._id) ? e.userVotes.find(function (e) {\n            return e.user._id === _this.props.conferenceState.myInfo._id;\n          }).key : [] : []\n        };\n      }) //Group by _id for easier use\n      .reduce(function (result, item) {\n        return _objectSpread({}, result, _defineProperty({}, item['pollId'], [].concat(_toConsumableArray(result[item['pollId']] || []), [item])));\n      }, {})\n    };\n\n    _this.handleVote = function () {\n      var voteInput = Object.keys(_this.state.initVal).map(function (key) {\n        return _this.state.initVal[key][0];\n      }); // console.log(voteInput)\n      // MUTATION:\n\n      client.mutate({\n        mutation: M_VOTE,\n        variables: {\n          voteInput: voteInput\n        }\n      }).then(function (e) {\n        return newNotification('Thành công! ', 'success', {\n          animationIn: ['animated', 'fadeIn']\n        });\n      }).catch(function (error) {\n        returnError('vote', {\n          error: error,\n          errorMessage: 'Please try again later!'\n        });\n      });\n    };\n\n    _this.handleChange = function (e, pollId, type) {\n      var value = type === _pollType.SINGLE || type === _pollType.OPEN_ANSWER ? e.target.value : e; // console.log(value)\n\n      _this.setState(function (preState) {\n        return {\n          initVal: _objectSpread({}, preState.initVal, _defineProperty({}, pollId, [{\n            answerKey: value,\n            pollId: pollId\n          }]))\n        };\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(UserView, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props$conferenc = this.props.conferenceState,\n          pollsInfo = _this$props$conferenc.pollsInfo,\n          myPermissions = _this$props$conferenc.myPermissions,\n          initVal = this.state.initVal,\n          handleVote = this.handleVote,\n          handleChange = this.handleChange;\n      var isLocked = pollsInfo[0].isLocked;\n      var canBePersonalPublic = pollsInfo[0].canBePersonalPublic;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"user-view-container\",\n        style: {\n          overflowY: 'scroll'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"userViewHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }\n      }, \"C\\xE2u h\\u1ECFi kh\\u1EA3o s\\xE1t: \")), pollsInfo && pollsInfo.slice().sort(function (a, b) {\n        return a.isRandom ? a.index - b.index : a.createdAt - b.createdAt;\n      }).map(function (pollInfo, index) {\n        var question = pollInfo.question,\n            answers = pollInfo.answers,\n            _id = pollInfo._id,\n            duration = pollInfo.duration;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: _id,\n          className: \"userviewWrapper\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"question\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 23\n          }\n        }, index + 1, \". \", question), duration && /*#__PURE__*/React.createElement(\"span\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 25\n          }\n        }, _this2.state.timeRemain > 0 ? moment(_this2.state.timeRemain).format('mm:ss') : 'Hết giờ')), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"answer\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 21\n          }\n        }, pollInfo.type === _pollType.SINGLE && /*#__PURE__*/React.createElement(_Radio.Group, {\n          value: initVal[_id][0].answerKey ? initVal[_id][0].answerKey[0] : null,\n          onChange: function onChange(e) {\n            return handleChange(e, _id, pollInfo.type);\n          },\n          disabled: !checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 25\n          }\n        }, answers.map(function (e, i) {\n          return /*#__PURE__*/React.createElement(_Radio, {\n            className: \"answer-radio\",\n            key: i,\n            value: e.key,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 29\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 31\n            }\n          }, e.value));\n        })), pollInfo.type === _pollType.MULTIPLE && /*#__PURE__*/React.createElement(_Checkbox.Group, {\n          options: answers.map(function (e) {\n            return {\n              label: \"\".concat(e.value),\n              value: e.key\n            };\n          }),\n          onChange: function onChange(e) {\n            return handleChange(e, _id, pollInfo.type);\n          },\n          defaultValue: initVal[_id][0].answerKey,\n          disabled: !checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 25\n          }\n        }), pollInfo.type === _pollType.OPEN_ANSWER && /*#__PURE__*/React.createElement(_Input, {\n          disabled: !checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked,\n          value: initVal[_id][0].answerKey,\n          onChange: function onChange(e) {\n            return handleChange(e, _id, pollInfo.type);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }\n        })));\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"userViewHeaderFooter\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        style: {\n          width: '30%'\n        },\n        disabled: isLocked,\n        type: 'primary',\n        onClick: handleVote,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          width: '100%',\n          textAlign: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 13\n        }\n      }, isLocked ? /*#__PURE__*/React.createElement(_Icon, {\n        type: \"lock\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 27\n        }\n      }) : /*#__PURE__*/React.createElement(_Icon, {\n        type: \"upload\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 50\n        }\n      }), \" G\\u1EEDi\")), canBePersonalPublic && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"canBePersonalPublic\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 35\n        }\n      }, \"C\\xE2u tr\\u1EA3 l\\u1EDDi c\\u1EE7a b\\u1EA1n c\\xF3 th\\u1EC3 \\u0111\\u01B0\\u1EE3c ghi l\\u1EA1i\")));\n    }\n  }]);\n\n  return UserView;\n}(Component), _temp)) || _class) || _class);\nexport default UserView;","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/conference2/collab-panel/PollCollapse/UserView.jsx"],"names":["React","Component","checkPermission","_pollType","inject","observer","client","M_VOTE","moment","returnError","newNotification","UserView","stores","state","initVal","props","conferenceState","pollsInfo","map","e","pollId","_id","answerKey","userVotes","user","includes","myInfo","find","key","reduce","result","item","handleVote","voteInput","Object","keys","mutate","mutation","variables","then","animationIn","catch","error","errorMessage","handleChange","type","value","SINGLE","OPEN_ANSWER","target","setState","preState","myPermissions","isLocked","canBePersonalPublic","overflowY","slice","sort","a","b","isRandom","index","createdAt","pollInfo","question","answers","duration","timeRemain","format","i","MULTIPLE","label","width","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { checkPermission, _pollType } from '@constants'\nimport { inject, observer } from 'mobx-react'\nimport { client, M_VOTE } from '@graphql'\nimport moment from 'moment'\nimport { returnError, newNotification } from '@utils'\n\nimport { Radio, Checkbox, Input, Button, Icon } from 'antd'\n\n@inject(({ stores }) => stores)\n@observer\nclass UserView extends Component {\n  state = {\n    initVal: this.props.conferenceState.pollsInfo\n      .map(e => ({\n        //Generate initial value for user answer\n        pollId: e._id,\n        answerKey: e.userVotes\n          ? e.userVotes.map(e => e.user._id).includes(this.props.conferenceState.myInfo._id)\n            ? e.userVotes.find(e => e.user._id === this.props.conferenceState.myInfo._id).key\n            : []\n          : []\n      })) //Group by _id for easier use\n      .reduce(\n        (result, item) => ({\n          ...result,\n          [item['pollId']]: [...(result[item['pollId']] || []), item]\n        }),\n        {}\n      )\n  }\n\n  handleVote = () => {\n    let voteInput = Object.keys(this.state.initVal).map(key => this.state.initVal[key][0])\n    // console.log(voteInput)\n    // MUTATION:\n    client\n      .mutate({\n        mutation: M_VOTE,\n        variables: {\n          voteInput\n        }\n      })\n      .then(e => {\n        return newNotification('Thành công! ', 'success', {\n          animationIn: ['animated', 'fadeIn']\n        })\n      })\n      .catch(error => {\n        returnError('vote', {\n          error,\n          errorMessage: 'Please try again later!'\n        })\n      })\n  }\n\n  handleChange = (e, pollId, type) => {\n    let value = type === _pollType.SINGLE || type === _pollType.OPEN_ANSWER ? e.target.value : e\n    // console.log(value)\n    this.setState(preState => ({\n      initVal: {\n        ...preState.initVal,\n        [pollId]: [{ answerKey: value, pollId }]\n      }\n    }))\n  }\n\n  render() {\n    const {\n      props: {\n        // conferenceState,\n        conferenceState: { pollsInfo, myPermissions }\n      },\n      state: { initVal },\n      handleVote,\n      handleChange\n    } = this\n\n    const isLocked = pollsInfo[0].isLocked\n    const canBePersonalPublic = pollsInfo[0].canBePersonalPublic\n    return (\n      <>\n        <div className='user-view-container' style={{ overflowY: 'scroll' }}>\n          <div className='userViewHeader'>\n            <span>Câu hỏi khảo sát: </span>\n          </div>\n          {pollsInfo &&\n            pollsInfo\n              .slice()\n              .sort((a, b) => (a.isRandom ? a.index - b.index : a.createdAt - b.createdAt))\n              .map((pollInfo, index) => {\n                const { question, answers, _id, duration } = pollInfo\n                return (\n                  <div key={_id} className='userviewWrapper'>\n                    <div className='question'>\n                      <span>\n                        {index + 1}. {question}\n                      </span>\n                      {duration && (\n                        <span>\n                          {this.state.timeRemain > 0 ? moment(this.state.timeRemain).format('mm:ss') : 'Hết giờ'}\n                        </span>\n                      )}\n                    </div>\n                    <div className='answer'>\n                      {pollInfo.type === _pollType.SINGLE && (\n                        <Radio.Group\n                          value={initVal[_id][0].answerKey ? initVal[_id][0].answerKey[0] : null}\n                          onChange={e => handleChange(e, _id, pollInfo.type)}\n                          disabled={!checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked}\n                        >\n                          {answers.map((e, i) => (\n                            <Radio className='answer-radio' key={i} value={e.key}>\n                              <span>{e.value}</span>\n                            </Radio>\n                          ))}\n                        </Radio.Group>\n                      )}\n\n                      {pollInfo.type === _pollType.MULTIPLE && (\n                        <Checkbox.Group\n                          options={answers.map(e => ({ label: `${e.value}`, value: e.key }))}\n                          onChange={e => handleChange(e, _id, pollInfo.type)}\n                          defaultValue={initVal[_id][0].answerKey}\n                          disabled={!checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked}\n                        />\n                      )}\n\n                      {pollInfo.type === _pollType.OPEN_ANSWER && (\n                        <Input\n                          disabled={!checkPermission(myPermissions, 'VOTE') || pollInfo.isLocked}\n                          value={initVal[_id][0].answerKey}\n                          onChange={e => handleChange(e, _id, pollInfo.type)}\n                        />\n                      )}\n                    </div>\n                  </div>\n                )\n              })}\n        </div>\n        <div className='userViewHeaderFooter'>\n          <Button style={{ width: '30%' }} disabled={isLocked} type={'primary'} onClick={handleVote}>\n            <span style={{ width: '100%', textAlign: 'center' }}>\n              {isLocked ? <Icon type='lock' /> : <Icon type='upload' />} Gửi\n            </span>\n          </Button>\n\n          {canBePersonalPublic && <div className='canBePersonalPublic'>Câu trả lời của bạn có thể được ghi lại</div>}\n        </div>\n      </>\n    )\n  }\n}\n\nexport default UserView\n"]},"metadata":{},"sourceType":"module"}