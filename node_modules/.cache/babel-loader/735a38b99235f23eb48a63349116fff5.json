{"ast":null,"code":"import _defineProperty from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport _objectSpread from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/components/tabsInviteRemind/TabUser.jsx\";\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport googleCalendarAPI from '../../../../calendar/GoogleCalendarAPI';\nimport client, { M_INVITE_USERS, M_SEND_EMAIL } from '@graphql';\nimport successIcon from \"@misc/images/toolbar/success.svg\";\nimport errorIcon from \"@misc/images/toolbar/error.svg\";\nimport { observer, inject } from 'mobx-react';\nvar STATUS = {\n  INVITE: 'INVITE',\n  SENDING: 'SENDING',\n  SENT: {\n    SUCCESS: 'SUCCESS',\n    ERROR: 'ERROR'\n  }\n};\nvar TabUser = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(TabUser, _React$PureComponent);\n\n  var _super = _createSuper(TabUser);\n\n  function TabUser() {\n    var _this;\n\n    _classCallCheck(this, TabUser);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      listInvite: [],\n      status: STATUS.INVITE\n    };\n\n    _this.validateEmail = function (email) {\n      var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      return re.test(String(email).toLowerCase());\n    };\n\n    _this.handleInviteUser = function () {\n      var _this$props = _this.props,\n          conference = _this$props.conference,\n          users = _this$props.users;\n\n      _this.setState(function (_preState) {\n        return _objectSpread({}, _preState, {\n          status: STATUS.SENDING\n        });\n      });\n\n      var emails = _this.state.listInvite.map(function (item) {\n        var data = users.filter(function (e) {\n          return e._id === item;\n        });\n        return {\n          email: data[0] ? data[0].email : ''\n        };\n      }).filter(function (e) {\n        return _this.validateEmail(e.email);\n      }); // Google API\n\n\n      if (_this.props.globalState.isGoogleAPI) {\n        if (conference.calendar) {\n          googleCalendarAPI.inviteAttendee(conference.calendar._id.eventId, emails);\n        }\n      }\n\n      client.mutate({\n        mutation: M_SEND_EMAIL,\n        variables: {\n          typeSend: 'REMIND',\n          typeEmail: 'DETAIL_CONFERENCE',\n          conferenceId: conference._id,\n          emails: emails.map(function (item) {\n            return item.email;\n          })\n        }\n      });\n      client.mutate({\n        mutation: M_INVITE_USERS,\n        variables: {\n          conferenceId: conference._id,\n          userIds: _this.state.listInvite\n        }\n      }).then(function (_ref2) {\n        var inviteUsers = _ref2.data.inviteUsers;\n\n        if (inviteUsers) {\n          _this.setState(function (_preState) {\n            return _objectSpread({}, _preState, {\n              status: STATUS.SENT.SUCCESS\n            });\n          });\n\n          _this.props._queryConferenceDetail(conference._id);\n\n          _this.setState({\n            visible: false\n          });\n        }\n      }).catch(function (errors) {\n        _this.setState(function (_preState) {\n          return _objectSpread({}, _preState, {\n            status: STATUS.SENT.ERROR\n          });\n        });\n      });\n    };\n\n    _this.renderChildren = function () {\n      var _this$props2 = _this.props,\n          users = _this$props2.users,\n          conference = _this$props2.conference;\n      var newUser = users.filter(function (item) {\n        return conference.users ? conference.users.findIndex(function (x) {\n          return x.user._id === item._id;\n        }) === -1 : false;\n      });\n      return newUser.map(function (item) {\n        return /*#__PURE__*/React.createElement(_Select.Option, {\n          key: item._id,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 14\n          }\n        }, \"\".concat(item.firstname, \" \").concat(item.lastname), \"(\", item.email, \")\");\n      });\n    };\n\n    _this.handleChange = function (value) {\n      _this.setState({\n        listInvite: value\n      });\n    };\n\n    _this.handleResetInvite = function () {\n      var conference = _this.props.conference;\n\n      _this.setState(function (_preState) {\n        return _objectSpread({}, _preState, {\n          status: STATUS.INVITE,\n          listInvite: []\n        });\n      });\n\n      _this.props.queryUsers();\n\n      _this.props._queryConferenceDetail(conference._id);\n    };\n\n    return _this;\n  }\n\n  _createClass(TabUser, [{\n    key: \"render\",\n    value: function render() {\n      var _renderElement;\n\n      var i18n = this.props.i18n;\n      var renderElement = (_renderElement = {}, _defineProperty(_renderElement, STATUS.INVITE, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-invite\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }\n      }, i18n.t('meeting.inviteUser')), /*#__PURE__*/React.createElement(_Select, {\n        className: \"user-conference-select\",\n        mode: \"multiple\",\n        style: {\n          width: '100%'\n        },\n        placeholder: i18n.t('meeting.pleaseSelect'),\n        value: this.state.listInvite,\n        onChange: this.handleChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }\n      }, this.renderChildren()), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        disabled: this.state.listInvite.length === 0,\n        onClick: this.handleInviteUser,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }\n      }, i18n.t('common.add')))), _defineProperty(_renderElement, STATUS.SENDING, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-loading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"spinner\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }\n      }, i18n.t('meeting.sentInvite')))), _defineProperty(_renderElement, STATUS.SENT.SUCCESS, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-sent\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: successIcon,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }\n      }, this.state.listInvite.length, \" \", i18n.t('meeting.sent')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"group-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.handleResetInvite,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.inviteMore')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        ghost: true,\n        onClick: this.props.handleCancel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.done'))))), _defineProperty(_renderElement, STATUS.SENT.ERROR, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"box-sent\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: errorIcon,\n        alt: \"icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }\n      }, this.state.listInvite.length, \" \", i18n.t('meeting.notsent')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"group-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.handleResetInvite,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.inviteMore')), /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        ghost: true,\n        onClick: this.props.handleCancel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 13\n        }\n      }, i18n.t('meeting.done'))))), _renderElement);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-user\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 7\n        }\n      }, renderElement[this.state.status]);\n    }\n  }]);\n\n  return TabUser;\n}(React.PureComponent), _temp)) || _class) || _class);\nexport default withTranslation()(TabUser);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/components/tabsInviteRemind/TabUser.jsx"],"names":["React","withTranslation","googleCalendarAPI","client","M_INVITE_USERS","M_SEND_EMAIL","observer","inject","STATUS","INVITE","SENDING","SENT","SUCCESS","ERROR","TabUser","stores","state","listInvite","status","validateEmail","email","re","test","String","toLowerCase","handleInviteUser","props","conference","users","setState","_preState","emails","map","item","data","filter","e","_id","globalState","isGoogleAPI","calendar","inviteAttendee","eventId","mutate","mutation","variables","typeSend","typeEmail","conferenceId","userIds","then","inviteUsers","_queryConferenceDetail","visible","catch","errors","renderChildren","newUser","findIndex","x","user","firstname","lastname","handleChange","value","handleResetInvite","queryUsers","i18n","renderElement","t","width","length","successIcon","handleCancel","errorIcon","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Select, Button } from 'antd'\nimport { withTranslation } from 'react-i18next'\n\nimport googleCalendarAPI from '../../../../calendar/GoogleCalendarAPI'\n\nimport client, { M_INVITE_USERS, M_SEND_EMAIL } from '@graphql'\n\nimport successIcon from '@misc/images/toolbar/success.svg'\nimport errorIcon from '@misc/images/toolbar/error.svg'\nimport { observer, inject } from 'mobx-react'\n\nconst STATUS = {\n  INVITE: 'INVITE',\n  SENDING: 'SENDING',\n  SENT: {\n    SUCCESS: 'SUCCESS',\n    ERROR: 'ERROR'\n  }\n}\n\n\n@inject(({ stores }) => stores)\n@observer\nclass TabUser extends React.PureComponent {\n  state = {\n    listInvite: [],\n    status: STATUS.INVITE\n  }\n\n  validateEmail = (email) => {\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  }\n\n  handleInviteUser = () => {\n    const { conference, users } = this.props\n    this.setState(_preState => ({\n      ..._preState,\n      status: STATUS.SENDING\n    }))\n\n    const emails = this.state.listInvite.map((item) => {\n      const data = users.filter((e) => e._id === item)\n      return {\n        email: data[0] ? data[0].email : ''\n      }\n    }).filter(e => this.validateEmail(e.email))\n\n    // Google API\n    if (this.props.globalState.isGoogleAPI) {\n      if (conference.calendar) {\n        googleCalendarAPI.inviteAttendee(conference.calendar._id.eventId, emails)\n      }\n    }\n\n\n    client\n      .mutate({\n        mutation: M_SEND_EMAIL,\n        variables: {\n          typeSend: 'REMIND',\n          typeEmail: 'DETAIL_CONFERENCE',\n          conferenceId: conference._id,\n          emails: emails.map(item => item.email)\n        }\n      })\n\n    client\n      .mutate({\n        mutation: M_INVITE_USERS,\n        variables: {\n          conferenceId: conference._id,\n          userIds: this.state.listInvite\n        }\n      })\n      .then(({ data: { inviteUsers } }) => {\n        if (inviteUsers) {\n          this.setState(_preState => ({\n            ..._preState,\n            status: STATUS.SENT.SUCCESS\n          }))\n\n          this.props._queryConferenceDetail(conference._id)\n          this.setState({ visible: false })\n        }\n      })\n      .catch(errors => {\n        this.setState(_preState => ({\n          ..._preState,\n          status: STATUS.SENT.ERROR\n        }))\n      })\n  }\n\n  renderChildren = () => {\n    const { users, conference } = this.props\n    const newUser = users.filter(item =>\n      conference.users ? conference.users.findIndex(x => x.user._id === item._id) === -1 : false\n    )\n    return newUser.map(item => {\n      return <Select.Option key={item._id}>{`${item.firstname} ${item.lastname}`}({item.email})</Select.Option>\n    })\n  }\n\n  handleChange = value => {\n    this.setState({ listInvite: value })\n  }\n\n  handleResetInvite = () => {\n    const { conference } = this.props\n\n    this.setState(_preState => ({\n      ..._preState,\n      status: STATUS.INVITE,\n      listInvite: []\n    }))\n    this.props.queryUsers()\n    this.props._queryConferenceDetail(conference._id)\n  }\n\n  render() {\n    const { i18n } = this.props\n\n    const renderElement = {\n      [STATUS.INVITE]: (\n        <div className='box-invite' >\n          <p>{i18n.t('meeting.inviteUser')}</p>\n          <Select\n            className='user-conference-select'\n            mode='multiple'\n            style={{ width: '100%' }}\n            placeholder={i18n.t('meeting.pleaseSelect')}\n            value={this.state.listInvite}\n            onChange={this.handleChange}\n          >\n            {this.renderChildren()}\n          </Select>\n          <Button\n            type='primary'\n            disabled={this.state.listInvite.length === 0}\n            onClick={this.handleInviteUser}\n          >\n            {i18n.t('common.add')}\n          </Button>\n        </div>\n      ),\n      [STATUS.SENDING]: (\n        <div className='box-loading'>\n          <div className='spinner'></div>\n          <p>{i18n.t('meeting.sentInvite')}</p>\n        </div>\n      ),\n      [STATUS.SENT.SUCCESS]: (\n        <div className='box-sent'>\n          <img src={successIcon} alt='icon' />\n          <span className='success'>{this.state.listInvite.length} {i18n.t('meeting.sent')}</span>\n          <div className='group-btn'>\n            <Button type='primary' onClick={this.handleResetInvite}>{i18n.t('meeting.inviteMore')}</Button>\n            <Button type='primary' ghost onClick={this.props.handleCancel}>{i18n.t('meeting.done')}</Button>\n          </div>\n        </div>\n      ),\n      [STATUS.SENT.ERROR]: (\n        <div className='box-sent'>\n          <img src={errorIcon} alt='icon' />\n          <span className='error'>{this.state.listInvite.length} {i18n.t('meeting.notsent')}</span>\n          <div className='group-btn'>\n            <Button type='primary' onClick={this.handleResetInvite}>{i18n.t('meeting.inviteMore')}</Button>\n            <Button type='primary' ghost onClick={this.props.handleCancel}>{i18n.t('meeting.done')}</Button>\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <div className='wrapper-user'>\n        {\n          renderElement[this.state.status]\n        }\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(TabUser)"]},"metadata":{},"sourceType":"module"}