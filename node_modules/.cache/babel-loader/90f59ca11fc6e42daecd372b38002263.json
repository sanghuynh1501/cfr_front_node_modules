{"ast":null,"code":"import \"antd/es/icon/style\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport _regeneratorRuntime from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\nvar _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/verifyEmail/index.jsx\";\n\nimport React from 'react';\nimport ReactNotification from 'react-notifications-component';\nimport './index.less';\nimport { decode } from 'jsonwebtoken';\nimport { withRouter } from 'react-router';\nimport { withTranslation } from 'react-i18next';\nimport client, { M_VERIFY_EMAIL } from '@graphql';\nimport { returnError } from '@utils';\n\nvar VerifyEmail = withRouter(_class = (_temp = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(VerifyEmail, _React$PureComponent);\n\n  var _super = _createSuper(VerifyEmail);\n\n  function VerifyEmail(props) {\n    var _this;\n\n    _classCallCheck(this, VerifyEmail);\n\n    _this = _super.call(this, props);\n\n    _this.handleVerifyEmail = function () {\n      client.mutate({\n        mutation: M_VERIFY_EMAIL,\n        variables: {\n          emailToken: _this.props.match.params.ID\n        }\n      }).then(function (_ref) {\n        var verifyEmail = _ref.data.verifyEmail;\n\n        if (!verifyEmail) {\n          return returnError('Verify Email', {\n            errorMessage: 'Có lỗi xảy ra'\n          }, {\n            container: 'top-right'\n          });\n        }\n\n        _this.setState({\n          isDone: true\n        });\n      }).catch(function (errors) {\n        return errors.graphQLErrors && errors.graphQLErrors[0].message.split(', ').map(function (item) {\n          returnError('Verify Email', {\n            errorMessage: _this.props.i18n.t(item)\n          }, {\n            container: 'top-right'\n          });\n          return false;\n        });\n      });\n    };\n\n    _this.state = {\n      email: null,\n      isDone: false,\n      invalid: false\n    };\n    return _this;\n  }\n\n  _createClass(VerifyEmail, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return decode(this.props.match.params.ID);\n\n              case 3:\n                data = _context.sent;\n\n                if (!(Date.now() >= data.exp * 1000)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error('token expired');\n\n              case 6:\n                this.setState({\n                  email: data.audience\n                });\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](0);\n                this.setState({\n                  invalid: true\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 9]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var i18n = this.props.i18n;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"verify-email-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-notification\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(ReactNotification, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"verify-email\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 13\n        }\n      }, \"Verify your e-mail to finish signing up for MD-Conference\"), this.state.invalid ? /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }\n      }, \"Invalid token\") : /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper-content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 19\n        }\n      }, \"Thank you for choosing MD-Conference\"), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 19\n        }\n      }, \"Please confirm that \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 42\n        }\n      }, this.state.email), \" is your e-mail address by clicking on the button below within 24 hours.\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"button-wrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        htmlType: \"submit\",\n        className: \"button-verify\",\n        onClick: !this.state.isDone ? this.handleVerifyEmail : function () {\n          return _this2.props.history.push('/login');\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }\n      }, !this.state.isDone ? i18n.t('verifyEmail.verify') : i18n.t('login.signIn'))), this.state.isDone && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"is-verified\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(_Icon, {\n        style: {\n          margin: '0px 5px'\n        },\n        type: \"check-square\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 25\n        }\n      }), \"Successfully verified\")))));\n    }\n  }]);\n\n  return VerifyEmail;\n}(React.PureComponent), _temp)) || _class;\n\nexport default withTranslation()(VerifyEmail);","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/verifyEmail/index.jsx"],"names":["React","ReactNotification","decode","withRouter","withTranslation","client","M_VERIFY_EMAIL","returnError","VerifyEmail","props","handleVerifyEmail","mutate","mutation","variables","emailToken","match","params","ID","then","verifyEmail","data","errorMessage","container","setState","isDone","catch","errors","graphQLErrors","message","split","map","item","i18n","t","state","email","invalid","Date","now","exp","Error","audience","history","push","margin","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactNotification from 'react-notifications-component'\nimport './index.less'\nimport { decode } from 'jsonwebtoken'\nimport { withRouter } from 'react-router'\nimport { withTranslation } from 'react-i18next'\nimport { Button, Icon } from 'antd'\nimport client, { M_VERIFY_EMAIL } from '@graphql'\nimport { returnError } from '@utils'\n\n@withRouter\nclass VerifyEmail extends React.PureComponent {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      email: null,\n      isDone: false,\n      invalid: false\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const data = await decode(this.props.match.params.ID)\n      if (Date.now() >= data.exp * 1000) {\n        throw new Error('token expired');\n      }\n      this.setState({ email: data.audience })\n    } catch (error) {\n      this.setState({ invalid: true })\n    }\n  }\n\n  handleVerifyEmail = () => {\n    client\n      .mutate({\n        mutation: M_VERIFY_EMAIL,\n        variables: {\n          emailToken: this.props.match.params.ID\n        }\n      })\n      .then(({ data: { verifyEmail } }) => {\n        if (!verifyEmail) {\n          return returnError(\n            'Verify Email',\n            {\n              errorMessage: 'Có lỗi xảy ra'\n            },\n            { container: 'top-right' }\n          )\n        }\n        this.setState({ isDone: true })\n      })\n      .catch(errors =>\n        errors.graphQLErrors && errors.graphQLErrors[0].message.split(', ').map(item => {\n          returnError(\n            'Verify Email',\n            {\n              errorMessage: this.props.i18n.t(item)\n            },\n            { container: 'top-right' }\n          )\n          return false\n        })\n      )\n  }\n\n  render() {\n    const { i18n } = this.props\n    return (\n      <div className='verify-email-wrapper'>\n        <div className='wrapper-notification'>\n          <ReactNotification />\n        </div>\n        <div className='verify-email'>\n          <div className='block'>\n            <h1>Verify your e-mail to finish signing up for MD-Conference</h1>\n            {this.state.invalid ? (\n              <p>Invalid token</p>\n            ) : (\n                <div className='wrapper-content'>\n                  <p>Thank you for choosing MD-Conference</p>\n                  <p>Please confirm that <b>{this.state.email}</b> is your e-mail address by clicking on the button below within 24 hours.</p>\n\n\n                  <div className='button-wrapper'>\n                    <Button\n                      type='primary'\n                      htmlType='submit'\n                      className='button-verify'\n                      onClick={!this.state.isDone ? this.handleVerifyEmail : () => this.props.history.push('/login')}\n                    >\n                      {!this.state.isDone ? i18n.t('verifyEmail.verify') : i18n.t('login.signIn')}\n                    </Button>\n                  </div>\n\n                  {this.state.isDone &&\n                    (\n                      <div className='is-verified'>\n                        <Icon style={{ margin: '0px 5px' }} type=\"check-square\" />\n                        Successfully verified\n                      </div>\n                    )}\n                </div>\n              )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default withTranslation()(VerifyEmail)\n"]},"metadata":{},"sourceType":"module"}