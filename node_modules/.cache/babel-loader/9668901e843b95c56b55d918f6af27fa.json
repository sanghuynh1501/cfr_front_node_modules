{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport _classCallCheck from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sang/js/cfr-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/home/sang/js/cfr-frontend/src/pages/dashboard/userDetail/CreateUser.jsx\";\n\nimport React from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router';\nimport { client, M_CREATE_USER, Q_NODES, Q_ROLES } from '@graphql';\nimport { returnError, newNotification, parseError, isSupperAdmin, hasPermission } from '@utils';\nimport { ROLE, PER } from '@constants';\nvar Option = _Select.Option;\nvar FormCreateUser = (_dec = inject(function (_ref) {\n  var stores = _ref.stores;\n  return stores;\n}), withRouter(_class = _dec(_class = observer(_class = (_temp = /*#__PURE__*/function (_React$Component) {\n  _inherits(FormCreateUser, _React$Component);\n\n  var _super = _createSuper(FormCreateUser);\n\n  function FormCreateUser() {\n    var _this;\n\n    _classCallCheck(this, FormCreateUser);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      roles: [],\n      nodes: []\n    };\n\n    _this.queryRolesApp = function () {\n      client.query({\n        query: Q_ROLES,\n        fetchPolicy: 'network-only',\n        variables: {\n          type: 'ROLE_APP'\n        }\n      }).then(function (_ref2) {\n        var roles = _ref2.data.roles;\n\n        if (!roles) {\n          throw new Error('notification.queryRoleError');\n        }\n\n        _this.setState({\n          roles: roles.filter(function (role) {\n            return role.code !== ROLE.R_SUPPERADMIN;\n          })\n        });\n      }).catch(function (error) {\n        return returnError('users', {\n          error: error,\n          errorMessage: _this.props.i18n.t(parseError(error))\n        }, {\n          container: 'top-right'\n        });\n      });\n    };\n\n    _this.handleSubmit = function (e) {\n      e.preventDefault();\n\n      _this.props.form.validateFields(function (err, values) {\n        //MUTATION CREATE USER \n        if (!err) {\n          client.mutate({\n            mutation: M_CREATE_USER,\n            variables: {\n              newUser: values\n            }\n          }).then(function (_ref3) {\n            var createUser = _ref3.data.createUser;\n\n            if (!createUser) {\n              throw new Error('notification.createUserSuccess');\n            }\n\n            _this.props.form.resetFields();\n\n            _this.props.history.push('/users');\n\n            newNotification(_this.props.i18n.t('notification.createUserSuccess'), 'success', {\n              container: 'top-right'\n            });\n          }).catch(function (err) {\n            returnError('Error', {\n              errorMessage: _this.props.i18n.t(parseError(err))\n            }, {\n              container: 'top-right'\n            });\n          });\n        }\n      });\n    };\n\n    _this.queryNodes = function () {\n      var inputSearch = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n        view: \"MANAGED_BY_ME\"\n      };\n      client.query({\n        query: Q_NODES,\n        fetchPolicy: 'network-only',\n        variables: {\n          inputSearch: inputSearch\n        }\n      }).then(function (_ref4) {\n        var nodes = _ref4.data.nodes;\n\n        _this.setState({\n          nodes: nodes\n        });\n      }).catch(function (error) {\n        return returnError('Get groups', {\n          error: error,\n          errorMessage: _this.props.i18n.t('notification.queryGroupError')\n        }, {\n          container: 'top-right'\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(FormCreateUser, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n          myInfo = _this$props.globalState.myInfo,\n          history = _this$props.history;\n      var profiles = myInfo === null || myInfo === void 0 ? void 0 : myInfo.profiles;\n      var isAllowViewListUser = isSupperAdmin(profiles) || hasPermission(profiles, PER.P_USER_CREATE);\n\n      if (!isAllowViewListUser) {\n        history.push('/');\n      }\n\n      this.queryNodes();\n      this.queryRolesApp();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          i18n = _this$props2.i18n,\n          getFieldDecorator = _this$props2.form.getFieldDecorator;\n      var optionRole = this.state.roles.map(function (item) {\n        return /*#__PURE__*/React.createElement(Option, {\n          key: item.code,\n          value: item.code,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 9\n          }\n        }, item.name);\n      });\n      var optionNodes = this.state.nodes.map(function (item) {\n        return /*#__PURE__*/React.createElement(Option, {\n          key: item._id,\n          value: item._id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 9\n          }\n        }, item.name);\n      });\n      return /*#__PURE__*/React.createElement(_Form, {\n        onSubmit: this.handleSubmit,\n        ref: \"form\",\n        style: {\n          width: '100%'\n        },\n        className: \"form-create-user\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('user.firstname'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('firstname', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requireFirstname')\n        }, {\n          pattern: /^[^\\s]/,\n          message: i18n.t('signup.noSpacingFirst')\n        }, {\n          // eslint-disable-next-line max-len\n          pattern: /^[a-zA-ZÀÁÂÃÈÉÊẾÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêếìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳýỵỷỹ\\s]+$/,\n          message: i18n.t('require.invalidCharacterNum')\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('user.lastname'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('lastname', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requireLastname')\n        }, {\n          pattern: /^[^\\s]/,\n          message: i18n.t('signup.noSpacingFirst')\n        }, {\n          // eslint-disable-next-line max-len\n          pattern: /^[a-zA-ZÀÁÂÃÈÉÊẾÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêếìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳýỵỷỹ]+$/,\n          message: i18n.t('require.invalidCharacterNum')\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('user.account'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('username', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requireAccount')\n        }, {\n          pattern: /^(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+$/,\n          message: 'Không được có các ký tự đặc biệt và khoảng cách'\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('common.password'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('password', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requirePassword')\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        type: \"password\",\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        placeholder: \"12345678\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"Email\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('email', {\n        rules: [{\n          type: 'email',\n          message: i18n.t('require.requireEmailCorrect')\n        }, {\n          required: true,\n          message: i18n.t('require.requireEmail')\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        placeholder: \"ABC@example.com\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('user.phoneNumber'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('phoneNumber', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requirePhone')\n        }, {\n          pattern: new RegExp('[+0-9]+'),\n          message: i18n.t('require.requirePhone')\n        }]\n      })( /*#__PURE__*/React.createElement(_Input, {\n        style: {\n          width: '380px',\n          height: '30px'\n        },\n        placeholder: \"0988758599\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 14\n        }\n      }))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: \"Role User\",\n        hasFeedback: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('roleCode', {\n        rules: [{\n          required: true,\n          message: i18n.t('require.requireChoiceRoleUser')\n        }]\n      })( /*#__PURE__*/React.createElement(_Select, {\n        placeholder: \"Please select role\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 14\n        }\n      }, optionRole))), /*#__PURE__*/React.createElement(_Form.Item, {\n        label: i18n.t('group.group'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 9\n        }\n      }, getFieldDecorator('nodeId', {\n        initialValue: ''\n      })( /*#__PURE__*/React.createElement(_Select, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Option, {\n        value: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 15\n        }\n      }, i18n.t('group.noGroup')), optionNodes))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"btnWrapper\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        htmlType: \"submit\",\n        className: \"btn-create\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }\n      }, i18n.t('common.save'))), /*#__PURE__*/React.createElement(_Form.Item, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(_Button, {\n        type: \"primary\",\n        className: \"btn-cancel\",\n        ghost: true,\n        onClick: this.props.backToDefault,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }\n      }, i18n.t('common.cancel')))));\n    }\n  }]);\n\n  return FormCreateUser;\n}(React.Component), _temp)) || _class) || _class) || _class);\nexport default _Form.create({\n  name: 'normal_login'\n})(withTranslation()(FormCreateUser));","map":{"version":3,"sources":["/home/sang/js/cfr-frontend/src/pages/dashboard/userDetail/CreateUser.jsx"],"names":["React","withTranslation","observer","inject","withRouter","client","M_CREATE_USER","Q_NODES","Q_ROLES","returnError","newNotification","parseError","isSupperAdmin","hasPermission","ROLE","PER","Option","FormCreateUser","stores","state","roles","nodes","queryRolesApp","query","fetchPolicy","variables","type","then","data","Error","setState","filter","role","code","R_SUPPERADMIN","catch","error","errorMessage","props","i18n","t","container","handleSubmit","e","preventDefault","form","validateFields","err","values","mutate","mutation","newUser","createUser","resetFields","history","push","queryNodes","inputSearch","view","myInfo","globalState","profiles","isAllowViewListUser","P_USER_CREATE","getFieldDecorator","optionRole","map","item","name","optionNodes","_id","width","rules","required","message","pattern","height","RegExp","initialValue","backToDefault","Component","create"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withTranslation } from 'react-i18next'\nimport { observer, inject } from 'mobx-react'\nimport { withRouter } from 'react-router'\n\nimport { Form, Input, Button, Select } from 'antd'\n\nimport { client, M_CREATE_USER, Q_NODES, Q_ROLES } from '@graphql'\nimport { returnError, newNotification, parseError, isSupperAdmin, hasPermission } from '@utils'\nimport { ROLE, PER } from '@constants'\n\nconst { Option } = Select\n\n@withRouter\n@inject(({ stores }) => stores)\n@observer\nclass FormCreateUser extends React.Component {\n  state = {\n    roles: [],\n    nodes: []\n  }\n\n  queryRolesApp = () => {\n    client\n      .query({\n        query: Q_ROLES,\n        fetchPolicy: 'network-only',\n        variables: {\n          type: 'ROLE_APP'\n        }\n      })\n      .then(({ data: { roles } }) => {\n        if (!roles) {\n          throw new Error('notification.queryRoleError')\n        }\n        this.setState({ roles: roles.filter(role => role.code !== ROLE.R_SUPPERADMIN) })\n      })\n      .catch(error =>\n        returnError(\n          'users',\n          { error, errorMessage: this.props.i18n.t(parseError(error)) },\n          { container: 'top-right' }\n        )\n      )\n  }\n\n\n  handleSubmit = e => {\n    e.preventDefault()\n    this.props.form.validateFields((err, values) => {\n      //MUTATION CREATE USER \n      if (!err) {\n        client\n          .mutate({\n            mutation: M_CREATE_USER,\n            variables: {\n              newUser: values\n            }\n          })\n          .then(({ data: { createUser } }) => {\n            if (!createUser) {\n              throw new Error('notification.createUserSuccess')\n            }\n            this.props.form.resetFields()\n            this.props.history.push('/users')\n            newNotification(this.props.i18n.t('notification.createUserSuccess'), 'success', { container: 'top-right' })\n          })\n          .catch(err => {\n            returnError(\n              'Error',\n              { errorMessage: this.props.i18n.t(parseError(err)) },\n              { container: 'top-right' }\n            )\n          })\n      }\n    })\n  }\n\n  queryNodes = (inputSearch = { view: \"MANAGED_BY_ME\" }) => {\n    client\n      .query({\n        query: Q_NODES,\n        fetchPolicy: 'network-only',\n        variables: {\n          inputSearch\n        }\n      })\n      .then(({ data: { nodes } }) => {\n        this.setState({ nodes })\n      })\n      .catch(error =>\n        returnError(\n          'Get groups',\n          {\n            error,\n            errorMessage: this.props.i18n.t('notification.queryGroupError')\n          },\n          { container: 'top-right' }\n        )\n      )\n  }\n\n  componentDidMount() {\n    const {\n      globalState: {\n        myInfo\n      },\n      history\n    } = this.props\n\n    const profiles = myInfo?.profiles\n    const isAllowViewListUser = isSupperAdmin(profiles) || hasPermission(profiles, PER.P_USER_CREATE)\n    if (!isAllowViewListUser) {\n      history.push('/')\n    }\n\n    this.queryNodes()\n    this.queryRolesApp()\n  }\n\n  render() {\n    const {\n      props: {\n        i18n,\n        form: { getFieldDecorator }\n      }\n    } = this\n\n    const optionRole = this.state.roles.map(item => {\n      return (\n        <Option key={item.code} value={item.code}>\n          {item.name}\n        </Option>\n      )\n    })\n\n    const optionNodes = this.state.nodes.map(item => {\n      return (\n        <Option key={item._id} value={item._id}>\n          {item.name}\n        </Option>\n      )\n    })\n\n    return (\n      <Form onSubmit={this.handleSubmit} ref='form' style={{ width: '100%' }} className='form-create-user'>\n        <Form.Item label={i18n.t('user.firstname')}>\n          {getFieldDecorator('firstname', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requireFirstname')\n              },\n              {\n                pattern: /^[^\\s]/,\n                message: i18n.t('signup.noSpacingFirst')\n              },\n              {\n                // eslint-disable-next-line max-len\n                pattern: /^[a-zA-ZÀÁÂÃÈÉÊẾÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêếìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳýỵỷỹ\\s]+$/,\n                message: i18n.t('require.invalidCharacterNum')\n              }\n            ]\n          })(<Input style={{ width: '380px', height: '30px' }} />)}\n        </Form.Item>\n\n        <Form.Item label={i18n.t('user.lastname')}>\n          {getFieldDecorator('lastname', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requireLastname')\n              },\n              {\n                pattern: /^[^\\s]/,\n                message: i18n.t('signup.noSpacingFirst')\n              },\n              {\n                // eslint-disable-next-line max-len\n                pattern: /^[a-zA-ZÀÁÂÃÈÉÊẾÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêếìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳýỵỷỹ]+$/,\n                message: i18n.t('require.invalidCharacterNum')\n              }\n            ]\n          })(<Input style={{ width: '380px', height: '30px' }} />)}\n        </Form.Item>\n\n        <Form.Item label={i18n.t('user.account')}>\n          {getFieldDecorator('username', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requireAccount')\n              },\n              {\n                pattern: /^(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+$/,\n                message: 'Không được có các ký tự đặc biệt và khoảng cách'\n              }\n            ]\n          })(<Input style={{ width: '380px', height: '30px' }} />)}\n        </Form.Item>\n\n        <Form.Item label={i18n.t('common.password')}>\n          {getFieldDecorator('password', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requirePassword')\n              }\n            ]\n          })(<Input type='password' style={{ width: '380px', height: '30px' }} placeholder='12345678' />)}\n        </Form.Item>\n\n        <Form.Item label='Email'>\n          {getFieldDecorator('email', {\n            rules: [\n              {\n                type: 'email',\n                message: i18n.t('require.requireEmailCorrect')\n              },\n              {\n                required: true,\n                message: i18n.t('require.requireEmail')\n              }\n            ]\n          })(<Input style={{ width: '380px', height: '30px' }} placeholder='ABC@example.com' />)}\n        </Form.Item>\n\n        <Form.Item label={i18n.t('user.phoneNumber')}>\n          {getFieldDecorator('phoneNumber', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requirePhone')\n              },\n              {\n                pattern: new RegExp('[+0-9]+'),\n                message: i18n.t('require.requirePhone')\n              }\n            ]\n          })(<Input style={{ width: '380px', height: '30px' }} placeholder='0988758599' />)}\n        </Form.Item>\n\n        <Form.Item label='Role User' hasFeedback>\n          {getFieldDecorator('roleCode', {\n            rules: [\n              {\n                required: true,\n                message: i18n.t('require.requireChoiceRoleUser')\n              }\n            ]\n          })(<Select placeholder='Please select role'>{optionRole}</Select>)}\n        </Form.Item>\n\n        <Form.Item label={i18n.t('group.group')}>\n          {getFieldDecorator('nodeId', {\n            initialValue: ''\n          })(\n            <Select>\n              <Option value=''>{i18n.t('group.noGroup')}</Option>\n              {optionNodes}\n            </Select>\n          )}\n        </Form.Item>\n\n        <div className='btnWrapper'>\n          <Form.Item>\n            <Button type='primary' htmlType='submit' className='btn-create'>\n              {i18n.t('common.save')}\n            </Button>\n          </Form.Item>\n          <Form.Item>\n            <Button type='primary' className='btn-cancel' ghost onClick={this.props.backToDefault}>\n              {i18n.t('common.cancel')}\n            </Button>\n          </Form.Item>\n        </div>\n      </Form>\n    )\n  }\n}\n\nexport default Form.create({ name: 'normal_login' })(withTranslation()(FormCreateUser))"]},"metadata":{},"sourceType":"module"}